
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../usage/">
      
      
        <link rel="next" href="../contributing/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>modules - procaliper</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#procaliper" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="procaliper" class="md-header__button md-logo" aria-label="procaliper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            procaliper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              modules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/LifeWorks/procaliper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    procaliper
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../installation/" class="md-tabs__link">
        
  
    
  
  installation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../usage/" class="md-tabs__link">
        
  
    
  
  usage

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  modules

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contributing/" class="md-tabs__link">
        
  
    
  
  contributing

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../authors/" class="md-tabs__link">
        
  
    
  
  authors

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../history/" class="md-tabs__link">
        
  
    
  
  history

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="procaliper" class="md-nav__button md-logo" aria-label="procaliper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    procaliper
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LifeWorks/procaliper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    procaliper
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    modules
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    modules
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#procaliper" class="md-nav__link">
    <span class="md-ellipsis">
      procaliper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.Protein" class="md-nav__link">
    <span class="md-ellipsis">
      Protein
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protein">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.fetch_pdb" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_pdb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.from_uniprot_id" class="md-nav__link">
    <span class="md-ellipsis">
      from_uniprot_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.from_uniprot_row" class="md-nav__link">
    <span class="md-ellipsis">
      from_uniprot_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_biopandas_pdb_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      get_biopandas_pdb_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_biopython_residues" class="md-nav__link">
    <span class="md-ellipsis">
      get_biopython_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_biopython_structure" class="md-nav__link">
    <span class="md-ellipsis">
      get_biopython_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_charge" class="md-nav__link">
    <span class="md-ellipsis">
      get_charge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_confidence" class="md-nav__link">
    <span class="md-ellipsis">
      get_confidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_cysteine_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_cysteine_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      get_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_titration" class="md-nav__link">
    <span class="md-ellipsis">
      get_titration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_titration_from_pkai" class="md-nav__link">
    <span class="md-ellipsis">
      get_titration_from_pkai
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_titration_from_propka" class="md-nav__link">
    <span class="md-ellipsis">
      get_titration_from_propka
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_titration_from_pypka" class="md-nav__link">
    <span class="md-ellipsis">
      get_titration_from_pypka
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.list_from_uniprot_ids" class="md-nav__link">
    <span class="md-ellipsis">
      list_from_uniprot_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.register_local_pdb" class="md-nav__link">
    <span class="md-ellipsis">
      register_local_pdb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.unravel_sites" class="md-nav__link">
    <span class="md-ellipsis">
      unravel_sites
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.network" class="md-nav__link">
    <span class="md-ellipsis">
      network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.network.contact_network" class="md-nav__link">
    <span class="md-ellipsis">
      contact_network
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.network.distance_network" class="md-nav__link">
    <span class="md-ellipsis">
      distance_network
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.network.euclidean_backbone" class="md-nav__link">
    <span class="md-ellipsis">
      euclidean_backbone
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.network.regulatory_distance_network" class="md-nav__link">
    <span class="md-ellipsis">
      regulatory_distance_network
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.protein_structure" class="md-nav__link">
    <span class="md-ellipsis">
      protein_structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="protein_structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.calculate_charge" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_charge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.calculate_cysteine_data" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_cysteine_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.calculate_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.residue_pLDDT" class="md-nav__link">
    <span class="md-ellipsis">
      residue_pLDDT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.charge" class="md-nav__link">
    <span class="md-ellipsis">
      charge
    </span>
  </a>
  
    <nav class="md-nav" aria-label="charge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.charge.ChargeData" class="md-nav__link">
    <span class="md-ellipsis">
      ChargeData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.charge.calculate_charge" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_charge
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.confidence" class="md-nav__link">
    <span class="md-ellipsis">
      confidence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confidence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.confidence.residue_pLDDT" class="md-nav__link">
    <span class="md-ellipsis">
      residue_pLDDT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.cysteine_data" class="md-nav__link">
    <span class="md-ellipsis">
      cysteine_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cysteine_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.cysteine_data.CysteineData" class="md-nav__link">
    <span class="md-ellipsis">
      CysteineData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.cysteine_data.calculate_cysteine_data" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_cysteine_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance" class="md-nav__link">
    <span class="md-ellipsis">
      distance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="distance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.contact_map" class="md-nav__link">
    <span class="md-ellipsis">
      contact_map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.distance_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      distance_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.proximity_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      proximity_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.region_distance" class="md-nav__link">
    <span class="md-ellipsis">
      region_distance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.region_distance_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      region_distance_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.region_proximity_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      region_proximity_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.residue_distance" class="md-nav__link">
    <span class="md-ellipsis">
      residue_distance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.sasa" class="md-nav__link">
    <span class="md-ellipsis">
      sasa
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sasa">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.sasa.SASAData" class="md-nav__link">
    <span class="md-ellipsis">
      SASAData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.sasa.calculate_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_sasa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.titration" class="md-nav__link">
    <span class="md-ellipsis">
      titration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="titration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.titration.TitrationData" class="md-nav__link">
    <span class="md-ellipsis">
      TitrationData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.titration.calculate_titration_propka" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_titration_propka
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.site_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      site_metadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="site_metadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData" class="md-nav__link">
    <span class="md-ellipsis">
      CustomSiteData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CustomSiteData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData.add_residue_numbers" class="md-nav__link">
    <span class="md-ellipsis">
      add_residue_numbers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData.add_site_data" class="md-nav__link">
    <span class="md-ellipsis">
      add_site_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData.table" class="md-nav__link">
    <span class="md-ellipsis">
      table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.SiteAnnotations" class="md-nav__link">
    <span class="md-ellipsis">
      SiteAnnotations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SiteAnnotations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.SiteAnnotations.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.SiteAnnotations.extract_annotation" class="md-nav__link">
    <span class="md-ellipsis">
      extract_annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.SiteAnnotations.table" class="md-nav__link">
    <span class="md-ellipsis">
      table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data" class="md-nav__link">
    <span class="md-ellipsis">
      custom_site_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="custom_site_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData" class="md-nav__link">
    <span class="md-ellipsis">
      CustomSiteData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CustomSiteData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.add_residue_numbers" class="md-nav__link">
    <span class="md-ellipsis">
      add_residue_numbers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.add_site_data" class="md-nav__link">
    <span class="md-ellipsis">
      add_site_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.table" class="md-nav__link">
    <span class="md-ellipsis">
      table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing" class="md-nav__link">
    <span class="md-ellipsis">
      uniprot_site_parsing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="uniprot_site_parsing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations" class="md-nav__link">
    <span class="md-ellipsis">
      SiteAnnotations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SiteAnnotations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.extract_annotation" class="md-nav__link">
    <span class="md-ellipsis">
      extract_annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.table" class="md-nav__link">
    <span class="md-ellipsis">
      table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.view" class="md-nav__link">
    <span class="md-ellipsis">
      view
    </span>
  </a>
  
    <nav class="md-nav" aria-label="view">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.view.ngl_scheme" class="md-nav__link">
    <span class="md-ellipsis">
      ngl_scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.view.protein_to_nglview" class="md-nav__link">
    <span class="md-ellipsis">
      protein_to_nglview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.view.nglview_utils" class="md-nav__link">
    <span class="md-ellipsis">
      nglview_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nglview_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.view.nglview_utils.ngl_scheme" class="md-nav__link">
    <span class="md-ellipsis">
      ngl_scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.view.nglview_utils.protein_to_nglview" class="md-nav__link">
    <span class="md-ellipsis">
      protein_to_nglview
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../authors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    authors
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    history
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#procaliper" class="md-nav__link">
    <span class="md-ellipsis">
      procaliper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.Protein" class="md-nav__link">
    <span class="md-ellipsis">
      Protein
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protein">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.fetch_pdb" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_pdb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.from_uniprot_id" class="md-nav__link">
    <span class="md-ellipsis">
      from_uniprot_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.from_uniprot_row" class="md-nav__link">
    <span class="md-ellipsis">
      from_uniprot_row
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_biopandas_pdb_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      get_biopandas_pdb_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_biopython_residues" class="md-nav__link">
    <span class="md-ellipsis">
      get_biopython_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_biopython_structure" class="md-nav__link">
    <span class="md-ellipsis">
      get_biopython_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_charge" class="md-nav__link">
    <span class="md-ellipsis">
      get_charge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_confidence" class="md-nav__link">
    <span class="md-ellipsis">
      get_confidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_cysteine_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_cysteine_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      get_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_titration" class="md-nav__link">
    <span class="md-ellipsis">
      get_titration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_titration_from_pkai" class="md-nav__link">
    <span class="md-ellipsis">
      get_titration_from_pkai
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_titration_from_propka" class="md-nav__link">
    <span class="md-ellipsis">
      get_titration_from_propka
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.get_titration_from_pypka" class="md-nav__link">
    <span class="md-ellipsis">
      get_titration_from_pypka
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.list_from_uniprot_ids" class="md-nav__link">
    <span class="md-ellipsis">
      list_from_uniprot_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.register_local_pdb" class="md-nav__link">
    <span class="md-ellipsis">
      register_local_pdb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.Protein.unravel_sites" class="md-nav__link">
    <span class="md-ellipsis">
      unravel_sites
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.network" class="md-nav__link">
    <span class="md-ellipsis">
      network
    </span>
  </a>
  
    <nav class="md-nav" aria-label="network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.network.contact_network" class="md-nav__link">
    <span class="md-ellipsis">
      contact_network
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.network.distance_network" class="md-nav__link">
    <span class="md-ellipsis">
      distance_network
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.network.euclidean_backbone" class="md-nav__link">
    <span class="md-ellipsis">
      euclidean_backbone
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.network.regulatory_distance_network" class="md-nav__link">
    <span class="md-ellipsis">
      regulatory_distance_network
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.protein_structure" class="md-nav__link">
    <span class="md-ellipsis">
      protein_structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="protein_structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.calculate_charge" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_charge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.calculate_cysteine_data" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_cysteine_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.calculate_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.residue_pLDDT" class="md-nav__link">
    <span class="md-ellipsis">
      residue_pLDDT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.charge" class="md-nav__link">
    <span class="md-ellipsis">
      charge
    </span>
  </a>
  
    <nav class="md-nav" aria-label="charge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.charge.ChargeData" class="md-nav__link">
    <span class="md-ellipsis">
      ChargeData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.charge.calculate_charge" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_charge
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.confidence" class="md-nav__link">
    <span class="md-ellipsis">
      confidence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="confidence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.confidence.residue_pLDDT" class="md-nav__link">
    <span class="md-ellipsis">
      residue_pLDDT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.cysteine_data" class="md-nav__link">
    <span class="md-ellipsis">
      cysteine_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cysteine_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.cysteine_data.CysteineData" class="md-nav__link">
    <span class="md-ellipsis">
      CysteineData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.cysteine_data.calculate_cysteine_data" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_cysteine_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance" class="md-nav__link">
    <span class="md-ellipsis">
      distance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="distance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.contact_map" class="md-nav__link">
    <span class="md-ellipsis">
      contact_map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.distance_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      distance_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.proximity_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      proximity_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.region_distance" class="md-nav__link">
    <span class="md-ellipsis">
      region_distance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.region_distance_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      region_distance_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.region_proximity_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      region_proximity_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.distance.residue_distance" class="md-nav__link">
    <span class="md-ellipsis">
      residue_distance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.sasa" class="md-nav__link">
    <span class="md-ellipsis">
      sasa
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sasa">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.sasa.SASAData" class="md-nav__link">
    <span class="md-ellipsis">
      SASAData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.sasa.calculate_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_sasa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.titration" class="md-nav__link">
    <span class="md-ellipsis">
      titration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="titration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.titration.TitrationData" class="md-nav__link">
    <span class="md-ellipsis">
      TitrationData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.protein_structure.titration.calculate_titration_propka" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_titration_propka
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.site_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      site_metadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="site_metadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData" class="md-nav__link">
    <span class="md-ellipsis">
      CustomSiteData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CustomSiteData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData.add_residue_numbers" class="md-nav__link">
    <span class="md-ellipsis">
      add_residue_numbers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData.add_site_data" class="md-nav__link">
    <span class="md-ellipsis">
      add_site_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.CustomSiteData.table" class="md-nav__link">
    <span class="md-ellipsis">
      table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.SiteAnnotations" class="md-nav__link">
    <span class="md-ellipsis">
      SiteAnnotations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SiteAnnotations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.SiteAnnotations.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.SiteAnnotations.extract_annotation" class="md-nav__link">
    <span class="md-ellipsis">
      extract_annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.SiteAnnotations.table" class="md-nav__link">
    <span class="md-ellipsis">
      table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data" class="md-nav__link">
    <span class="md-ellipsis">
      custom_site_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="custom_site_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData" class="md-nav__link">
    <span class="md-ellipsis">
      CustomSiteData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CustomSiteData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.add_residue_numbers" class="md-nav__link">
    <span class="md-ellipsis">
      add_residue_numbers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.add_site_data" class="md-nav__link">
    <span class="md-ellipsis">
      add_site_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.table" class="md-nav__link">
    <span class="md-ellipsis">
      table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing" class="md-nav__link">
    <span class="md-ellipsis">
      uniprot_site_parsing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="uniprot_site_parsing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations" class="md-nav__link">
    <span class="md-ellipsis">
      SiteAnnotations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SiteAnnotations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.extract_annotation" class="md-nav__link">
    <span class="md-ellipsis">
      extract_annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.table" class="md-nav__link">
    <span class="md-ellipsis">
      table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procaliper.view" class="md-nav__link">
    <span class="md-ellipsis">
      view
    </span>
  </a>
  
    <nav class="md-nav" aria-label="view">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.view.ngl_scheme" class="md-nav__link">
    <span class="md-ellipsis">
      ngl_scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.view.protein_to_nglview" class="md-nav__link">
    <span class="md-ellipsis">
      protein_to_nglview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.view.nglview_utils" class="md-nav__link">
    <span class="md-ellipsis">
      nglview_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nglview_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#procaliper.view.nglview_utils.ngl_scheme" class="md-nav__link">
    <span class="md-ellipsis">
      ngl_scheme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procaliper.view.nglview_utils.protein_to_nglview" class="md-nav__link">
    <span class="md-ellipsis">
      protein_to_nglview
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>modules</h1>

<div class="doc doc-object doc-module">



<a id="procaliper"></a>
    <div class="doc doc-contents first">

        <p>Top-level package for procaliper.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="procaliper.Protein" class="doc doc-heading">
            <code>Protein</code>


<a href="#procaliper.Protein" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


              <details class="quote">
                <summary>Source code in <code>procaliper/_protein.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Protein</span><span class="p">:</span>
    <span class="n">UNIPROT_SITE_PATTERNS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Active site&quot;</span><span class="p">:</span> <span class="s2">&quot;ACT_SITE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Binding site&quot;</span><span class="p">:</span> <span class="s2">&quot;BINDING&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DNA binding&quot;</span><span class="p">:</span> <span class="s2">&quot;DNA_BIND&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Disulfide bond&quot;</span><span class="p">:</span> <span class="s2">&quot;DISULFID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Beta strand&quot;</span><span class="p">:</span> <span class="s2">&quot;STRAND&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Helix&quot;</span><span class="p">:</span> <span class="s2">&quot;HELIX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Turn&quot;</span><span class="p">:</span> <span class="s2">&quot;TURN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PTM&quot;</span><span class="p">:</span> <span class="s2">&quot;MOD_RES&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="s2">&quot;REGION&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">UNIPROT_SITE_PATTERNS_RECTIFIED</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="s2">&quot;ACT_SITE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;binding&quot;</span><span class="p">:</span> <span class="s2">&quot;BINDING&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dna_binding&quot;</span><span class="p">:</span> <span class="s2">&quot;DNA_BIND&quot;</span><span class="p">,</span>
        <span class="s2">&quot;disulfide_bond&quot;</span><span class="p">:</span> <span class="s2">&quot;DISULFID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;beta_strand&quot;</span><span class="p">:</span> <span class="s2">&quot;STRAND&quot;</span><span class="p">,</span>
        <span class="s2">&quot;helix&quot;</span><span class="p">:</span> <span class="s2">&quot;HELIX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;turn&quot;</span><span class="p">:</span> <span class="s2">&quot;TURN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;modified_residue&quot;</span><span class="p">:</span> <span class="s2">&quot;MOD_RES&quot;</span><span class="p">,</span>
        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="s2">&quot;REGION&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">UNIPROT_API_DEFAULT_FIELDS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reviewed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;protein_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gene_names&quot;</span><span class="p">,</span>
        <span class="s2">&quot;organism_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;length&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sequence&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ft_act_site&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ft_binding&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ft_dna_bind&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ft_disulfid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ft_strand&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ft_helix&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ft_turn&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ft_mod_res&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ft_region&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_relative</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">site_annotations</span><span class="p">:</span> <span class="n">SiteAnnotations</span> <span class="o">=</span> <span class="n">SiteAnnotations</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_site_data</span><span class="p">:</span> <span class="n">CustomSiteData</span> <span class="o">=</span> <span class="n">CustomSiteData</span><span class="p">([],</span> <span class="p">{})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span><span class="p">:</span> <span class="n">structure</span><span class="o">.</span><span class="n">sasa</span><span class="o">.</span><span class="n">SASAData</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span><span class="p">:</span> <span class="n">structure</span><span class="o">.</span><span class="n">charge</span><span class="o">.</span><span class="n">ChargeData</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span><span class="p">:</span> <span class="n">structure</span><span class="o">.</span><span class="n">cysteine_data</span><span class="o">.</span><span class="n">CysteineData</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span><span class="p">:</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">TitrationData</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_rectify_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">new_label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">new_label</span> <span class="o">=</span> <span class="n">new_label</span><span class="o">.</span><span class="n">removesuffix</span><span class="p">(</span><span class="s2">&quot;_site_sites&quot;</span><span class="p">)</span>
        <span class="n">new_label</span> <span class="o">=</span> <span class="n">new_label</span><span class="o">.</span><span class="n">removesuffix</span><span class="p">(</span><span class="s2">&quot;_site&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_label</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_rectify_data_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Standardize the features names in self.data</span>

<span class="sd">        Replaces all spaces with underscores and lowercases the keys, and then</span>
<span class="sd">        replaces all instances of &quot;_site_sites&quot; with &quot;_sites&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">new_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rectify_label</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">new_key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_uniprot_row</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Protein</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Protein object from a row from a Uniprot table</span>

<span class="sd">        Args:</span>
<span class="sd">            row (dict[str, Any]): Contains the data from the Uniprot table. Must</span>
<span class="sd">                have &quot;Sequence&quot; or &quot;sequence&quot; as a key.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If &quot;Sequence&quot; or &quot;sequence&quot; is not found in the row.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Protein: A processed and standardized protein object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;Sequence&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Sequence&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;sequence&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequence not found in row: </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">custom_site_data</span><span class="o">.</span><span class="n">add_residue_numbers</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]))</span>
        <span class="n">p</span><span class="o">.</span><span class="n">site_annotations</span> <span class="o">=</span> <span class="n">SiteAnnotations</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">_rectify_label</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_SITE_PATTERNS_RECTIFIED</span><span class="p">:</span>
                <span class="n">uniprot_description_id</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_SITE_PATTERNS_RECTIFIED</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">p</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">extract_annotation</span><span class="p">(</span><span class="n">uniprot_description_id</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_SITE_PATTERNS</span><span class="p">:</span>
                <span class="n">uniprot_description_id</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_SITE_PATTERNS</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">p</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">extract_annotation</span><span class="p">(</span><span class="n">uniprot_description_id</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">p</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_uniprot_id</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">uniprot_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">from_db</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UniProtKB_AC-ID&quot;</span><span class="p">,</span>
        <span class="n">to_db</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UniProtKB-Swiss-Prot&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Protein</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new Protein object from a Uniprot ID (fetches with Uniprot API)</span>

<span class="sd">        Args:</span>
<span class="sd">            uniprot_id (str): The Uniprot ID of the protein.</span>
<span class="sd">            fields (list[str] | None, optional): The fields to retrieve from</span>
<span class="sd">                Uniprot. If `None`, `Protein.UNIPROT_API_DEFAULT_FIELDS` is used.</span>
<span class="sd">            from_db (str, optional): The database to retrieve the ID from.</span>
<span class="sd">                Defaults to &quot;UniProtKB_AC-ID&quot;.</span>
<span class="sd">            to_db (str, optional): The database to map to.</span>
<span class="sd">                Defaults to &quot;UniProtKB-Swiss-Prot&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If we cannot retrieve the Uniprot ID.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Protein: A processed and standardized protein object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_API_DEFAULT_FIELDS</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">ProtMapper</span><span class="p">()</span>

        <span class="n">result</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">],</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span> <span class="n">from_db</span><span class="o">=</span><span class="n">from_db</span><span class="p">,</span> <span class="n">to_db</span><span class="o">=</span><span class="n">to_db</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uniprot id not retrieved: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;From&quot;</span><span class="p">:</span> <span class="s2">&quot;entry&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;Length&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Length&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_uniprot_row</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">list_from_uniprot_ids</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">uniprot_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">from_db</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UniProtKB_AC-ID&quot;</span><span class="p">,</span>
        <span class="n">to_db</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UniProtKB-Swiss-Prot&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Protein</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a list of Protein objects from a list of Uniprot IDs (fetches with Uniprot API)</span>

<span class="sd">        Args:</span>
<span class="sd">            uniprot_ids (list[str]): The Uniprot IDs of the proteins.</span>
<span class="sd">            fields (list[str] | None, optional): The fields to retrieve from</span>
<span class="sd">                Uniprot. If `None`, `Protein.UNIPROT_API_DEFAULT_FIELDS` is used.</span>
<span class="sd">            from_db (str, optional): The database to retrieve the IDs from.</span>
<span class="sd">                Defaults to &quot;UniProtKB_AC-ID&quot;.</span>
<span class="sd">            to_db (str, optional): The database to map to.</span>
<span class="sd">                Defaults to &quot;UniProtKB-Swiss-Prot&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If we cannot retrieve the Uniprot IDs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[Protein]: A list of processed and standardized protein objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_API_DEFAULT_FIELDS</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">ProtMapper</span><span class="p">()</span>

        <span class="n">result</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">ids</span><span class="o">=</span><span class="n">uniprot_ids</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span> <span class="n">from_db</span><span class="o">=</span><span class="n">from_db</span><span class="p">,</span> <span class="n">to_db</span><span class="o">=</span><span class="n">to_db</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uniprot id not retrieved: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;From&quot;</span><span class="p">:</span> <span class="s2">&quot;entry&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;Length&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Length&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">from_uniprot_row</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Protein</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">sasa_data</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">charge_data</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">cysteine_data</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">residue_data_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">chain</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_charge</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_sasa</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_cysteine_data</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_titration</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;pLDDT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_confidence</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_biopandas_pdb_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PandasPdb</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the PDB dataframe for the protein.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `pdb_location_absolute` is not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PandasPdb: A biopandas dataframe that contains the PDB file information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PDB location not set; use `fetch_pdb` first&quot;</span><span class="p">)</span>
        <span class="n">ppdb</span> <span class="o">=</span> <span class="n">PandasPdb</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ppdb</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_biopython_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the biopython structure for the protein.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `pdb_location_absolute` is not set.</span>
<span class="sd">            ValueError: If the PDB file cannot be parsed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Structure: A biopython Structure object for the protein.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PDB location not set; use `fetch_pdb` first&quot;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">QUIET</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">Structure</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to parse PDB file.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">structure</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_biopython_residues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the biopython residues for the protein.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `pdb_location_absolute` is not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[Residue]: A list of biopython residues for the protein.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PDB location not set; use `fetch_pdb` first&quot;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">QUIET</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">)</span>
        <span class="n">reslist</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">structure</span> <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">model</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">reslist</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetches precomputed confidence data from pdb file.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `confidence_data` is not already stored and</span>
<span class="sd">                `pdb_location_absolute` is not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[float]: A list of confidence values for each residue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confidence_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">confidence</span><span class="o">.</span><span class="n">residue_pLDDT</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Confidence data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_sasa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">sasa</span><span class="o">.</span><span class="n">SASAData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetches precomputed SASA data for the protein, or computes it.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `sasa_data` is not already stored and</span>
<span class="sd">                `pdb_location_absolute` is not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            structure.sasa.SASAData: A :class:`protein_structure.sasa.SASAData`</span>
<span class="sd">                object containing the SASA values for residues and atoms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">sasa</span><span class="o">.</span><span class="n">calculate_sasa</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;SASA data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_charge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gasteiger&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">charge</span><span class="o">.</span><span class="n">ChargeData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetches precomputed charge data for the protein, or computes it.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Args:</span>
<span class="sd">            method (str, optional): The method used for the charge calculation.</span>
<span class="sd">                Examples include &#39;qtpie&#39;, &#39;eem&#39;, &#39;gasteiger&#39;. Defaults to</span>
<span class="sd">                &#39;gasteiger&#39;. For a full list reference</span>
<span class="sd">                https://open-babel.readthedocs.io/en/latest/Charges/charges.html</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `charge_data` is not already stored and</span>
<span class="sd">                `pdb_location_absolute` is not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            structure.charge.ChargeData: A :class:`protein_structure.charge.ChargeData`</span>
<span class="sd">                object containing the charge values for residues and atoms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span><span class="p">[</span><span class="s2">&quot;charge_method&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span><span class="p">[</span><span class="s2">&quot;charge_method&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">method</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">charge</span><span class="o">.</span><span class="n">calculate_charge</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">last_charge_method</span> <span class="o">=</span> <span class="n">method</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Charge data for specified method not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_cysteine_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">cysteine_data</span><span class="o">.</span><span class="n">CysteineData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetches precomputed size data for the protein, or computes it.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `cysteine_data` is not already stored and</span>
<span class="sd">                `pdb_location_absolute` is not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            structure.size.CysteineData: A :class:`protein_structure.size.CysteineData`</span>
<span class="sd">                object containing the size values for cystein sites.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">cysteine_data</span><span class="o">.</span><span class="n">calculate_cysteine_data</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Size data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_titration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">TitrationData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Runs the default titration calculation for the protein.</span>

<span class="sd">        Equivalent to running `self.get_titration_from_propka`.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `titration_data` is not already stored and</span>
<span class="sd">                `pdb_location_absolute` is not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            structure.titration.TitrationData: A</span>
<span class="sd">                :class:`protein_structure.titration.TitrationData` object containing</span>
<span class="sd">                the titration values for residues.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_titration_from_propka</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_titration_from_propka</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">TitrationData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetches precomputed titration data for the protein, or computes it.</span>

<span class="sd">        Uses :func:`protein_structure.titration.calculate_titration_propka` if</span>
<span class="sd">        `self.titration_data` is not already stored.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `titration_data` is not already stored and</span>
<span class="sd">                `pdb_location_absolute` is not set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            structure.titration.TitrationData: A</span>
<span class="sd">                :class:`protein_structure.titration.TitrationData` object containing</span>
<span class="sd">                the titration values for residues.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">calculate_titration_propka</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Titration data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_titration_from_pypka</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">TitrationData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetches precomputed titration data for the protein, or computes it.</span>

<span class="sd">        Uses :func:`protein_structure.titration.calculate_titration_pypka` if</span>
<span class="sd">        `self.titration_data` is not already stored. Requires pypka to be</span>
<span class="sd">        installed, which has dependencies that are not FOSS. Please be sure to</span>
<span class="sd">        verify that you are legally allowed to use pypka.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `titration_data` is not already stored and</span>
<span class="sd">                `pdb_location_absolute` is not set. ImportError: If pypka is not</span>
<span class="sd">                installed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            structure.titration.TitrationData: A</span>
<span class="sd">                :class:`protein_structure.titration.TitrationData` object containing</span>
<span class="sd">                the titration values forresidues.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">calculate_titration_pypka</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Titration data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_titration_from_pkai</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">TitrationData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetches precomputed titration data for the protein, or computes it.</span>

<span class="sd">        Uses :func:`protein_structure.titration.calculate_titration_pkai` if</span>
<span class="sd">        `self.titration_data` is not already stored. Requires pkai to be</span>
<span class="sd">        installed. Note that this method is a deep-learning model, not a</span>
<span class="sd">        physics-based calculation.</span>

<span class="sd">        Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">        file in `self.pdb_location_absolute`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `titration_data` is not already stored and</span>
<span class="sd">                `pdb_location_absolute` is not set.</span>

<span class="sd">        Returns: structure.titration.TitrationData: A</span>
<span class="sd">            :class:`protein_structure.titration.TitrationData` object containing</span>
<span class="sd">                the titration values for residues.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">calculate_titration_pkai</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Titration data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_custom_site_data_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">site_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_site_data</span><span class="o">.</span><span class="n">residue_number</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custom_site_data</span><span class="o">.</span><span class="n">add_residue_numbers</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_site_data</span><span class="o">.</span><span class="n">add_site_data</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">site_data</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">unravel_sites</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">selected_aas</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="n">AminoAcidLetter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">selected_keys</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Split the protein into individual sites, recording values for each.</span>

<span class="sd">        Args:</span>
<span class="sd">            selected_aas: A set of amino acids letters to include in the output.</span>
<span class="sd">                If `None` (default), all amino acids will be included.</span>
<span class="sd">            selected_keys: A set of keys belonging to this `Protein` object&#39;s</span>
<span class="sd">                `data` dictionary to include in the output. If `None` (default),</span>
<span class="sd">                all keys are used.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[str, list[Any]]: A dictionary mapping keys to lists of values.</span>
<span class="sd">                Each list is a parallel array of the same length as the protein</span>
<span class="sd">                sequence (after filtering out non-selected amino acids).&quot;&quot;&quot;</span>
        <span class="n">tbl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">table</span><span class="p">()</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_site_data</span><span class="o">.</span><span class="n">table</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selected_keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selected_keys</span> <span class="o">=</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tbl</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">-</span> <span class="p">{</span><span class="s2">&quot;sequence&quot;</span><span class="p">}</span>
        <span class="n">tbl_keys</span> <span class="o">=</span> <span class="n">selected_keys</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">tbl</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">data_keys</span> <span class="o">=</span> <span class="n">selected_keys</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">assert</span> <span class="n">tbl_keys</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">data_keys</span><span class="p">)</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">selected_keys</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">site</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">selected_aas</span> <span class="ow">and</span> <span class="n">site</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">selected_aas</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tbl_keys</span><span class="p">:</span>
                <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tbl</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">index</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_keys</span><span class="p">:</span>
                <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>  <span class="c1"># will be the same for all sites</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fetch_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetches the PDB file for the protein (from the AlphaFold database by default).</span>

<span class="sd">        Args:</span>
<span class="sd">            save_path (str | None, optional): The path to save the PDB file to.</span>
<span class="sd">                If `None`, the protein name will be used as the file name.</span>
<span class="sd">                Defaults to `None`.</span>
<span class="sd">            url (str | None, optional): The URL to fetch the PDB file from.</span>
<span class="sd">                Defaults to `None`, in which case the AlphaFold database is used.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If the response status code is not 200, meaning we could</span>
<span class="sd">                not fetch the PDB from the database.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://alphafold.ebi.ac.uk/files/AF-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">-F1-model_v4.pdb&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">save_path</span><span class="p">:</span>
            <span class="n">save_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.pdb&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to fetch PDB: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_relative</span> <span class="o">=</span> <span class="n">save_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_local_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_to_pdb_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets pdb file for protein object using local pdb file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path_to_pdb_file (str | None, optional): Path to local PDB file.</span>
<span class="sd">                Defaults to `None`, in which case it assumes a file with &#39;entry&#39;.pdb.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path_to_pdb_file</span><span class="p">:</span>
            <span class="n">path_to_pdb_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.pdb&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_relative</span> <span class="o">=</span> <span class="n">path_to_pdb_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path_to_pdb_file</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_site_aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">aa</span><span class="p">:</span> <span class="n">AminoAcidLetter</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;sequence&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sequence entry not found in data&quot;</span><span class="p">)</span>

        <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">site</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sequence</span><span class="p">[</span><span class="n">site</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">aa</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.fetch_pdb" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fetch_pdb</span><span class="p">(</span><span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#procaliper.Protein.fetch_pdb" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fetches the PDB file for the protein (from the AlphaFold database by default).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>save_path</code></td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to save the PDB file to.
If <code>None</code>, the protein name will be used as the file name.
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>url</code></td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The URL to fetch the PDB file from.
Defaults to <code>None</code>, in which case the AlphaFold database is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Exception</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the response status code is not 200, meaning we could
not fetch the PDB from the database.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fetch_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches the PDB file for the protein (from the AlphaFold database by default).</span>

<span class="sd">    Args:</span>
<span class="sd">        save_path (str | None, optional): The path to save the PDB file to.</span>
<span class="sd">            If `None`, the protein name will be used as the file name.</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        url (str | None, optional): The URL to fetch the PDB file from.</span>
<span class="sd">            Defaults to `None`, in which case the AlphaFold database is used.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If the response status code is not 200, meaning we could</span>
<span class="sd">            not fetch the PDB from the database.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://alphafold.ebi.ac.uk/files/AF-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">-F1-model_v4.pdb&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">save_path</span><span class="p">:</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.pdb&quot;</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to fetch PDB: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_relative</span> <span class="o">=</span> <span class="n">save_path</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.from_uniprot_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_uniprot_id</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">from_db</span><span class="o">=</span><span class="s1">&#39;UniProtKB_AC-ID&#39;</span><span class="p">,</span> <span class="n">to_db</span><span class="o">=</span><span class="s1">&#39;UniProtKB-Swiss-Prot&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#procaliper.Protein.from_uniprot_id" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a new Protein object from a Uniprot ID (fetches with Uniprot API)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>uniprot_id</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Uniprot ID of the protein.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fields</code></td>
            <td>
                  <code>list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fields to retrieve from
Uniprot. If <code>None</code>, <code>Protein.UNIPROT_API_DEFAULT_FIELDS</code> is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>from_db</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The database to retrieve the ID from.
Defaults to "UniProtKB_AC-ID".</p>
              </div>
            </td>
            <td>
                  <code>&#39;UniProtKB_AC-ID&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>to_db</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The database to map to.
Defaults to "UniProtKB-Swiss-Prot".</p>
              </div>
            </td>
            <td>
                  <code>&#39;UniProtKB-Swiss-Prot&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If we cannot retrieve the Uniprot ID.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Protein</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper._protein.Protein" href="#procaliper.Protein">Protein</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A processed and standardized protein object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_uniprot_id</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">uniprot_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">from_db</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UniProtKB_AC-ID&quot;</span><span class="p">,</span>
    <span class="n">to_db</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UniProtKB-Swiss-Prot&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Protein</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new Protein object from a Uniprot ID (fetches with Uniprot API)</span>

<span class="sd">    Args:</span>
<span class="sd">        uniprot_id (str): The Uniprot ID of the protein.</span>
<span class="sd">        fields (list[str] | None, optional): The fields to retrieve from</span>
<span class="sd">            Uniprot. If `None`, `Protein.UNIPROT_API_DEFAULT_FIELDS` is used.</span>
<span class="sd">        from_db (str, optional): The database to retrieve the ID from.</span>
<span class="sd">            Defaults to &quot;UniProtKB_AC-ID&quot;.</span>
<span class="sd">        to_db (str, optional): The database to map to.</span>
<span class="sd">            Defaults to &quot;UniProtKB-Swiss-Prot&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If we cannot retrieve the Uniprot ID.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Protein: A processed and standardized protein object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span><span class="p">:</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_API_DEFAULT_FIELDS</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">ProtMapper</span><span class="p">()</span>

    <span class="n">result</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">],</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span> <span class="n">from_db</span><span class="o">=</span><span class="n">from_db</span><span class="p">,</span> <span class="n">to_db</span><span class="o">=</span><span class="n">to_db</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uniprot id not retrieved: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;From&quot;</span><span class="p">:</span> <span class="s2">&quot;entry&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;Length&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Length&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_uniprot_row</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.from_uniprot_row" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_uniprot_row</span><span class="p">(</span><span class="n">row</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#procaliper.Protein.from_uniprot_row" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a new Protein object from a row from a Uniprot table</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>row</code></td>
            <td>
                  <code>dict[str, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains the data from the Uniprot table. Must
have "Sequence" or "sequence" as a key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If "Sequence" or "sequence" is not found in the row.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Protein</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper._protein.Protein" href="#procaliper.Protein">Protein</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A processed and standardized protein object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_uniprot_row</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Protein</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new Protein object from a row from a Uniprot table</span>

<span class="sd">    Args:</span>
<span class="sd">        row (dict[str, Any]): Contains the data from the Uniprot table. Must</span>
<span class="sd">            have &quot;Sequence&quot; or &quot;sequence&quot; as a key.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If &quot;Sequence&quot; or &quot;sequence&quot; is not found in the row.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Protein: A processed and standardized protein object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;Sequence&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Sequence&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s2">&quot;sequence&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequence not found in row: </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">custom_site_data</span><span class="o">.</span><span class="n">add_residue_numbers</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]))</span>
    <span class="n">p</span><span class="o">.</span><span class="n">site_annotations</span> <span class="o">=</span> <span class="n">SiteAnnotations</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">_rectify_label</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_SITE_PATTERNS_RECTIFIED</span><span class="p">:</span>
            <span class="n">uniprot_description_id</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_SITE_PATTERNS_RECTIFIED</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">p</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">extract_annotation</span><span class="p">(</span><span class="n">uniprot_description_id</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_SITE_PATTERNS</span><span class="p">:</span>
            <span class="n">uniprot_description_id</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_SITE_PATTERNS</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">p</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">extract_annotation</span><span class="p">(</span><span class="n">uniprot_description_id</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_biopandas_pdb_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_biopandas_pdb_dataframe</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_biopandas_pdb_dataframe" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the PDB dataframe for the protein.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PandasPdb</code></td>            <td>
                  <code><span title="biopandas.pdb.PandasPdb">PandasPdb</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A biopandas dataframe that contains the PDB file information.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_biopandas_pdb_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PandasPdb</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the PDB dataframe for the protein.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `pdb_location_absolute` is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PandasPdb: A biopandas dataframe that contains the PDB file information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PDB location not set; use `fetch_pdb` first&quot;</span><span class="p">)</span>
    <span class="n">ppdb</span> <span class="o">=</span> <span class="n">PandasPdb</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ppdb</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_biopython_residues" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_biopython_residues</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_biopython_residues" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the biopython residues for the protein.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<span title="Bio.PDB.Residue.Residue">Residue</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[Residue]: A list of biopython residues for the protein.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_biopython_residues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the biopython residues for the protein.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `pdb_location_absolute` is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[Residue]: A list of biopython residues for the protein.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PDB location not set; use `fetch_pdb` first&quot;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">QUIET</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">)</span>
    <span class="n">reslist</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">structure</span> <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">model</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">reslist</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_biopython_structure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_biopython_structure</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_biopython_structure" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the biopython structure for the protein.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the PDB file cannot be parsed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Structure</code></td>            <td>
                  <code><span title="Bio.PDB.Structure.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A biopython Structure object for the protein.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_biopython_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the biopython structure for the protein.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `pdb_location_absolute` is not set.</span>
<span class="sd">        ValueError: If the PDB file cannot be parsed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Structure: A biopython Structure object for the protein.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PDB location not set; use `fetch_pdb` first&quot;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">QUIET</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">Structure</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to parse PDB file.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">structure</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_charge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_charge</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;gasteiger&#39;</span><span class="p">)</span></code>

<a href="#procaliper.Protein.get_charge" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fetches precomputed charge data for the protein, or computes it.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>method</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method used for the charge calculation.
Examples include 'qtpie', 'eem', 'gasteiger'. Defaults to
'gasteiger'. For a full list reference
https://open-babel.readthedocs.io/en/latest/Charges/charges.html</p>
              </div>
            </td>
            <td>
                  <code>&#39;gasteiger&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>charge_data</code> is not already stored and
<code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.charge.ChargeData" href="#procaliper.protein_structure.charge.ChargeData">ChargeData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>structure.charge.ChargeData: A :class:<code>protein_structure.charge.ChargeData</code>
object containing the charge values for residues and atoms.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_charge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gasteiger&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">charge</span><span class="o">.</span><span class="n">ChargeData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches precomputed charge data for the protein, or computes it.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Args:</span>
<span class="sd">        method (str, optional): The method used for the charge calculation.</span>
<span class="sd">            Examples include &#39;qtpie&#39;, &#39;eem&#39;, &#39;gasteiger&#39;. Defaults to</span>
<span class="sd">            &#39;gasteiger&#39;. For a full list reference</span>
<span class="sd">            https://open-babel.readthedocs.io/en/latest/Charges/charges.html</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `charge_data` is not already stored and</span>
<span class="sd">            `pdb_location_absolute` is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        structure.charge.ChargeData: A :class:`protein_structure.charge.ChargeData`</span>
<span class="sd">            object containing the charge values for residues and atoms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span><span class="p">[</span><span class="s2">&quot;charge_method&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span><span class="p">[</span><span class="s2">&quot;charge_method&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">method</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">charge</span><span class="o">.</span><span class="n">calculate_charge</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_charge_method</span> <span class="o">=</span> <span class="n">method</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Charge data for specified method not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_confidence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_confidence</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_confidence" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fetches precomputed confidence data from pdb file.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>confidence_data</code> is not already stored and
<code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[float]: A list of confidence values for each residue.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches precomputed confidence data from pdb file.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `confidence_data` is not already stored and</span>
<span class="sd">            `pdb_location_absolute` is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[float]: A list of confidence values for each residue.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_data</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">confidence</span><span class="o">.</span><span class="n">residue_pLDDT</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Confidence data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_cysteine_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cysteine_data</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_cysteine_data" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fetches precomputed size data for the protein, or computes it.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>cysteine_data</code> is not already stored and
<code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.cysteine_data.CysteineData" href="#procaliper.protein_structure.cysteine_data.CysteineData">CysteineData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>structure.size.CysteineData: A :class:<code>protein_structure.size.CysteineData</code>
object containing the size values for cystein sites.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_cysteine_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">cysteine_data</span><span class="o">.</span><span class="n">CysteineData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches precomputed size data for the protein, or computes it.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `cysteine_data` is not already stored and</span>
<span class="sd">            `pdb_location_absolute` is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        structure.size.CysteineData: A :class:`protein_structure.size.CysteineData`</span>
<span class="sd">            object containing the size values for cystein sites.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">cysteine_data</span><span class="o">.</span><span class="n">calculate_cysteine_data</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cysteine_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Size data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_sasa" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sasa</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_sasa" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fetches precomputed SASA data for the protein, or computes it.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>sasa_data</code> is not already stored and
<code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.sasa.SASAData" href="#procaliper.protein_structure.sasa.SASAData">SASAData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>structure.sasa.SASAData: A :class:<code>protein_structure.sasa.SASAData</code>
object containing the SASA values for residues and atoms.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_sasa</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">sasa</span><span class="o">.</span><span class="n">SASAData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches precomputed SASA data for the protein, or computes it.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `sasa_data` is not already stored and</span>
<span class="sd">            `pdb_location_absolute` is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        structure.sasa.SASAData: A :class:`protein_structure.sasa.SASAData`</span>
<span class="sd">            object containing the SASA values for residues and atoms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">sasa</span><span class="o">.</span><span class="n">calculate_sasa</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sasa_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;SASA data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_titration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_titration</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_titration" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Runs the default titration calculation for the protein.</p>
<p>Equivalent to running <code>self.get_titration_from_propka</code>.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>titration_data</code> is not already stored and
<code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.titration.TitrationData" href="#procaliper.protein_structure.titration.TitrationData">TitrationData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>structure.titration.TitrationData: A
:class:<code>protein_structure.titration.TitrationData</code> object containing
the titration values for residues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_titration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">TitrationData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Runs the default titration calculation for the protein.</span>

<span class="sd">    Equivalent to running `self.get_titration_from_propka`.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `titration_data` is not already stored and</span>
<span class="sd">            `pdb_location_absolute` is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        structure.titration.TitrationData: A</span>
<span class="sd">            :class:`protein_structure.titration.TitrationData` object containing</span>
<span class="sd">            the titration values for residues.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_titration_from_propka</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_titration_from_pkai" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_titration_from_pkai</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_titration_from_pkai" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fetches precomputed titration data for the protein, or computes it.</p>
<p>Uses :func:<code>protein_structure.titration.calculate_titration_pkai</code> if
<code>self.titration_data</code> is not already stored. Requires pkai to be
installed. Note that this method is a deep-learning model, not a
physics-based calculation.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>titration_data</code> is not already stored and
<code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">structure.titration.TitrationData: A</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.titration.TitrationData" href="#procaliper.protein_structure.titration.TitrationData">TitrationData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the titration values for residues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_titration_from_pkai</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">TitrationData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches precomputed titration data for the protein, or computes it.</span>

<span class="sd">    Uses :func:`protein_structure.titration.calculate_titration_pkai` if</span>
<span class="sd">    `self.titration_data` is not already stored. Requires pkai to be</span>
<span class="sd">    installed. Note that this method is a deep-learning model, not a</span>
<span class="sd">    physics-based calculation.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `titration_data` is not already stored and</span>
<span class="sd">            `pdb_location_absolute` is not set.</span>

<span class="sd">    Returns: structure.titration.TitrationData: A</span>
<span class="sd">        :class:`protein_structure.titration.TitrationData` object containing</span>
<span class="sd">            the titration values for residues.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">calculate_titration_pkai</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Titration data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_titration_from_propka" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_titration_from_propka</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_titration_from_propka" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fetches precomputed titration data for the protein, or computes it.</p>
<p>Uses :func:<code>protein_structure.titration.calculate_titration_propka</code> if
<code>self.titration_data</code> is not already stored.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>titration_data</code> is not already stored and
<code>pdb_location_absolute</code> is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.titration.TitrationData" href="#procaliper.protein_structure.titration.TitrationData">TitrationData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>structure.titration.TitrationData: A
:class:<code>protein_structure.titration.TitrationData</code> object containing
the titration values for residues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_titration_from_propka</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">TitrationData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches precomputed titration data for the protein, or computes it.</span>

<span class="sd">    Uses :func:`protein_structure.titration.calculate_titration_propka` if</span>
<span class="sd">    `self.titration_data` is not already stored.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `titration_data` is not already stored and</span>
<span class="sd">            `pdb_location_absolute` is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        structure.titration.TitrationData: A</span>
<span class="sd">            :class:`protein_structure.titration.TitrationData` object containing</span>
<span class="sd">            the titration values for residues.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">calculate_titration_propka</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Titration data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.get_titration_from_pypka" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_titration_from_pypka</span><span class="p">()</span></code>

<a href="#procaliper.Protein.get_titration_from_pypka" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fetches precomputed titration data for the protein, or computes it.</p>
<p>Uses :func:<code>protein_structure.titration.calculate_titration_pypka</code> if
<code>self.titration_data</code> is not already stored. Requires pypka to be
installed, which has dependencies that are not FOSS. Please be sure to
verify that you are legally allowed to use pypka.</p>
<p>Must run <code>self.fetch_pdb</code> first or specify an abosulute path to the PDB
file in <code>self.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>titration_data</code> is not already stored and
<code>pdb_location_absolute</code> is not set. ImportError: If pypka is not
installed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.titration.TitrationData" href="#procaliper.protein_structure.titration.TitrationData">TitrationData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>structure.titration.TitrationData: A
:class:<code>protein_structure.titration.TitrationData</code> object containing
the titration values forresidues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_titration_from_pypka</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">TitrationData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches precomputed titration data for the protein, or computes it.</span>

<span class="sd">    Uses :func:`protein_structure.titration.calculate_titration_pypka` if</span>
<span class="sd">    `self.titration_data` is not already stored. Requires pypka to be</span>
<span class="sd">    installed, which has dependencies that are not FOSS. Please be sure to</span>
<span class="sd">    verify that you are legally allowed to use pypka.</span>

<span class="sd">    Must run `self.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    file in `self.pdb_location_absolute`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `titration_data` is not already stored and</span>
<span class="sd">            `pdb_location_absolute` is not set. ImportError: If pypka is not</span>
<span class="sd">            installed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        structure.titration.TitrationData: A</span>
<span class="sd">            :class:`protein_structure.titration.TitrationData` object containing</span>
<span class="sd">            the titration values forresidues.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">titration</span><span class="o">.</span><span class="n">calculate_titration_pypka</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">titration_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Titration data not stored, and PDB location not set; use `fetch_pdb` first&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.list_from_uniprot_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_from_uniprot_ids</span><span class="p">(</span><span class="n">uniprot_ids</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">from_db</span><span class="o">=</span><span class="s1">&#39;UniProtKB_AC-ID&#39;</span><span class="p">,</span> <span class="n">to_db</span><span class="o">=</span><span class="s1">&#39;UniProtKB-Swiss-Prot&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#procaliper.Protein.list_from_uniprot_ids" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a list of Protein objects from a list of Uniprot IDs (fetches with Uniprot API)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>uniprot_ids</code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Uniprot IDs of the proteins.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fields</code></td>
            <td>
                  <code>list[str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fields to retrieve from
Uniprot. If <code>None</code>, <code>Protein.UNIPROT_API_DEFAULT_FIELDS</code> is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>from_db</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The database to retrieve the IDs from.
Defaults to "UniProtKB_AC-ID".</p>
              </div>
            </td>
            <td>
                  <code>&#39;UniProtKB_AC-ID&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>to_db</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The database to map to.
Defaults to "UniProtKB-Swiss-Prot".</p>
              </div>
            </td>
            <td>
                  <code>&#39;UniProtKB-Swiss-Prot&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If we cannot retrieve the Uniprot IDs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="procaliper._protein.Protein" href="#procaliper.Protein">Protein</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[Protein]: A list of processed and standardized protein objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">list_from_uniprot_ids</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">uniprot_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">from_db</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UniProtKB_AC-ID&quot;</span><span class="p">,</span>
    <span class="n">to_db</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UniProtKB-Swiss-Prot&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Protein</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a list of Protein objects from a list of Uniprot IDs (fetches with Uniprot API)</span>

<span class="sd">    Args:</span>
<span class="sd">        uniprot_ids (list[str]): The Uniprot IDs of the proteins.</span>
<span class="sd">        fields (list[str] | None, optional): The fields to retrieve from</span>
<span class="sd">            Uniprot. If `None`, `Protein.UNIPROT_API_DEFAULT_FIELDS` is used.</span>
<span class="sd">        from_db (str, optional): The database to retrieve the IDs from.</span>
<span class="sd">            Defaults to &quot;UniProtKB_AC-ID&quot;.</span>
<span class="sd">        to_db (str, optional): The database to map to.</span>
<span class="sd">            Defaults to &quot;UniProtKB-Swiss-Prot&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If we cannot retrieve the Uniprot IDs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[Protein]: A list of processed and standardized protein objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span><span class="p">:</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">UNIPROT_API_DEFAULT_FIELDS</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">ProtMapper</span><span class="p">()</span>

    <span class="n">result</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">ids</span><span class="o">=</span><span class="n">uniprot_ids</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span> <span class="n">from_db</span><span class="o">=</span><span class="n">from_db</span><span class="p">,</span> <span class="n">to_db</span><span class="o">=</span><span class="n">to_db</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uniprot id not retrieved: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;From&quot;</span><span class="p">:</span> <span class="s2">&quot;entry&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;Length&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Length&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">from_uniprot_row</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.register_local_pdb" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_local_pdb</span><span class="p">(</span><span class="n">path_to_pdb_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#procaliper.Protein.register_local_pdb" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Sets pdb file for protein object using local pdb file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>path_to_pdb_file</code></td>
            <td>
                  <code>str | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to local PDB file.
Defaults to <code>None</code>, in which case it assumes a file with 'entry'.pdb.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">register_local_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_to_pdb_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets pdb file for protein object using local pdb file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path_to_pdb_file (str | None, optional): Path to local PDB file.</span>
<span class="sd">            Defaults to `None`, in which case it assumes a file with &#39;entry&#39;.pdb.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">path_to_pdb_file</span><span class="p">:</span>
        <span class="n">path_to_pdb_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.pdb&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_relative</span> <span class="o">=</span> <span class="n">path_to_pdb_file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pdb_location_absolute</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path_to_pdb_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.Protein.unravel_sites" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unravel_sites</span><span class="p">(</span><span class="n">selected_aas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selected_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#procaliper.Protein.unravel_sites" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Split the protein into individual sites, recording values for each.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selected_aas</code></td>
            <td>
                  <code>None | set[<span title="procaliper.type_aliases.AminoAcidLetter">AminoAcidLetter</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A set of amino acids letters to include in the output.
If <code>None</code> (default), all amino acids will be included.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>selected_keys</code></td>
            <td>
                  <code>None | set[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A set of keys belonging to this <code>Protein</code> object's
<code>data</code> dictionary to include in the output. If <code>None</code> (default),
all keys are used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, list[Any]]: A dictionary mapping keys to lists of values.
Each list is a parallel array of the same length as the protein
sequence (after filtering out non-selected amino acids).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/_protein.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unravel_sites</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">selected_aas</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="n">AminoAcidLetter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">selected_keys</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split the protein into individual sites, recording values for each.</span>

<span class="sd">    Args:</span>
<span class="sd">        selected_aas: A set of amino acids letters to include in the output.</span>
<span class="sd">            If `None` (default), all amino acids will be included.</span>
<span class="sd">        selected_keys: A set of keys belonging to this `Protein` object&#39;s</span>
<span class="sd">            `data` dictionary to include in the output. If `None` (default),</span>
<span class="sd">            all keys are used.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, list[Any]]: A dictionary mapping keys to lists of values.</span>
<span class="sd">            Each list is a parallel array of the same length as the protein</span>
<span class="sd">            sequence (after filtering out non-selected amino acids).&quot;&quot;&quot;</span>
    <span class="n">tbl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">table</span><span class="p">()</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_site_data</span><span class="o">.</span><span class="n">table</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">selected_keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">selected_keys</span> <span class="o">=</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tbl</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">-</span> <span class="p">{</span><span class="s2">&quot;sequence&quot;</span><span class="p">}</span>
    <span class="n">tbl_keys</span> <span class="o">=</span> <span class="n">selected_keys</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">tbl</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">data_keys</span> <span class="o">=</span> <span class="n">selected_keys</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">assert</span> <span class="n">tbl_keys</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">data_keys</span><span class="p">)</span>
    <span class="n">res</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">selected_keys</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">site</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">selected_aas</span> <span class="ow">and</span> <span class="n">site</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">selected_aas</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tbl_keys</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tbl</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">index</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_keys</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>  <span class="c1"># will be the same for all sites</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>



<div class="doc doc-object doc-module">



<h2 id="procaliper.network" class="doc doc-heading">
            <code>network</code>


<a href="#procaliper.network" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="procaliper.network.contact_network" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contact_network</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">max_dist_angstroms</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span></code>

<a href="#procaliper.network.contact_network" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Constructs a contact network from a protein.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>protein</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper._protein.Protein" href="#procaliper.Protein">Protein</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Protein object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_dist_angstroms</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum distance between residues to be considered a contact. Defaults to 10.0.</p>
              </div>
            </td>
            <td>
                  <code>10.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.Graph: Contact network.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/network.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contact_network</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">,</span> <span class="n">max_dist_angstroms</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructs a contact network from a protein.</span>

<span class="sd">    Args:</span>
<span class="sd">        protein (Protein): Protein object.</span>
<span class="sd">        max_dist_angstroms (float, optional): Maximum distance between residues to be considered a contact. Defaults to 10.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nx.Graph: Contact network.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span>
        <span class="n">psd</span><span class="o">.</span><span class="n">contact_map</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">get_biopython_structure</span><span class="p">(),</span> <span class="n">max_dist_angstroms</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.network.distance_network" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">distance_network</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">max_dist_angstroms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

<a href="#procaliper.network.distance_network" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Constructs a distance network from a protein.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>protein</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper._protein.Protein" href="#procaliper.Protein">Protein</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Protein object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_dist_angstroms</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum distance between residues.
Values greater than this will be set to np.inf. Defaults to 20.</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.Graph: Distance network.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/network.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">distance_network</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">,</span> <span class="n">max_dist_angstroms</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructs a distance network from a protein.</span>

<span class="sd">    Args:</span>
<span class="sd">        protein (Protein): Protein object.</span>
<span class="sd">        max_dist_angstroms (float, optional): Maximum distance between residues.</span>
<span class="sd">            Values greater than this will be set to np.inf. Defaults to 20.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nx.Graph: Distance network.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span>
        <span class="n">psd</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">get_biopython_structure</span><span class="p">(),</span> <span class="n">max_dist_angstroms</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;proximity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;d2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">g</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.network.euclidean_backbone" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">euclidean_backbone</span><span class="p">(</span><span class="n">g</span><span class="p">)</span></code>

<a href="#procaliper.network.euclidean_backbone" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the Euclidean backbone of a distance network.</p>
<p>The Euclidean backbone of a weighted graph g is the smallest subgraph of g that contains
all shortest paths where a path length is determined by the square root of the sum of the
squared edge weights.</p>
<p>This is useful for sparsifying a distance network without disconnecting it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>g</code></td>
            <td>
                  <code><span title="networkx.Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance network. Edges must have an attribute "d2" representing the
squared edge weight. This is computed by <code>distance_network</code> and
<code>regulatory_distance_network</code> automatically.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.Graph: Euclidean backbone.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/network.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">euclidean_backbone</span><span class="p">(</span><span class="n">g</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the Euclidean backbone of a distance network.</span>

<span class="sd">    The Euclidean backbone of a weighted graph g is the smallest subgraph of g that contains</span>
<span class="sd">    all shortest paths where a path length is determined by the square root of the sum of the</span>
<span class="sd">    squared edge weights.</span>

<span class="sd">    This is useful for sparsifying a distance network without disconnecting it.</span>

<span class="sd">    Args:</span>
<span class="sd">        g (nx.Graph): Distance network. Edges must have an attribute &quot;d2&quot; representing the</span>
<span class="sd">            squared edge weight. This is computed by `distance_network` and</span>
<span class="sd">            `regulatory_distance_network` automatically.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nx.Graph: Euclidean backbone.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dc</span><span class="o">.</span><span class="n">backbone</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;d2&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;metric&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.network.regulatory_distance_network" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">regulatory_distance_network</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span></code>

<a href="#procaliper.network.regulatory_distance_network" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Constructs a regulatory region distance network from a protein.</p>
<p>Distances are computed between PTM sites, annotated regions, binding sites, and active sites.</p>
<p>Node labels will be 1-indexed and inclusive (e.g., <code>"5..7"</code> refers to residues 5, 6, and 7).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>protein</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper._protein.Protein" href="#procaliper.Protein">Protein</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Protein object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.Graph: Distance network.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/network.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">regulatory_distance_network</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructs a regulatory region distance network from a protein.</span>

<span class="sd">    Distances are computed between PTM sites, annotated regions, binding sites, and active sites.</span>

<span class="sd">    Node labels will be 1-indexed and inclusive (e.g., `&quot;5..7&quot;` refers to residues 5, 6, and 7).</span>

<span class="sd">    Args:</span>
<span class="sd">        protein (Protein): Protein object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nx.Graph: Distance network.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ptms</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">ptm</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">}</span>
    <span class="n">binding</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sa">f</span><span class="s2">&quot;b_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">binding</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span>
    <span class="p">}</span>
    <span class="n">active</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;a_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">active</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">}</span>
    <span class="n">regions</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">site_annotations</span><span class="o">.</span><span class="n">regions</span>

    <span class="n">all_regs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">ptms</span><span class="p">,</span> <span class="o">**</span><span class="n">binding</span><span class="p">,</span> <span class="o">**</span><span class="n">active</span><span class="p">,</span> <span class="o">**</span><span class="n">regions</span><span class="p">}</span>

    <span class="n">protein_residues</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">get_biopython_residues</span><span class="p">()</span>
    <span class="n">all_regs_residues</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="p">[</span><span class="n">protein_residues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">all_regs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">all_regs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_region_label</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">region_type</span><span class="o">=</span><span class="n">_region_type</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">residues</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k1</span><span class="p">,</span> <span class="n">v1</span> <span class="ow">in</span> <span class="n">all_regs_residues</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">k2</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="n">all_regs_residues</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k1</span> <span class="o">==</span> <span class="n">k2</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">region_distance</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">d2</span><span class="o">=</span><span class="n">weight</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">proximity</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">weight</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">g</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="procaliper.protein_structure" class="doc doc-heading">
            <code>protein_structure</code>


<a href="#procaliper.protein_structure" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="procaliper.protein_structure.calculate_charge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_charge</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gasteiger&#39;</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.calculate_charge" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Computes the charge of residue sites in a PDB file.</p>
<p>By default, the method used is 'gasteiger', but this is configurable in
<code>hyperparameters.py</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pdb_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the PDB file. shortname (str): The
shortname of the protein (typically will be UniProt ID).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>method</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method used for the charge calculation.
Examples include 'qtpie', 'eem', 'gasteiger'. Defaults to
'gasteiger'. For a full list reference
https://open-babel.readthedocs.io/en/latest/Charges/charges.html</p>
              </div>
            </td>
            <td>
                  <code>&#39;gasteiger&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the charge method is not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ChargeData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.charge.ChargeData" href="#procaliper.protein_structure.charge.ChargeData">ChargeData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A data class for holding charge data from computed from a
PDB file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/charge.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_charge</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gasteiger&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChargeData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the charge of residue sites in a PDB file.</span>

<span class="sd">    By default, the method used is &#39;gasteiger&#39;, but this is configurable in</span>
<span class="sd">    `hyperparameters.py`.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdb_filename (str): The path to the PDB file. shortname (str): The</span>
<span class="sd">            shortname of the protein (typically will be UniProt ID).</span>
<span class="sd">        method (str, optional): The method used for the charge calculation.</span>
<span class="sd">            Examples include &#39;qtpie&#39;, &#39;eem&#39;, &#39;gasteiger&#39;. Defaults to</span>
<span class="sd">            &#39;gasteiger&#39;. For a full list reference</span>
<span class="sd">            https://open-babel.readthedocs.io/en/latest/Charges/charges.html</span>


<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the charge method is not found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ChargeData: A data class for holding charge data from computed from a</span>
<span class="sd">            PDB file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pbmol</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">pybel</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="n">pdb_filename</span><span class="p">))</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">pbmol</span><span class="o">.</span><span class="n">OBMol</span>

    <span class="c1"># Applies the model and computes charges.</span>
    <span class="n">ob_charge_model</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBChargeModel</span><span class="o">.</span><span class="n">FindType</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ob_charge_model</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Charge method not found. Please check hyperparameters.py&quot;</span><span class="p">)</span>
    <span class="n">ob_charge_model</span><span class="o">.</span><span class="n">ComputeCharges</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">charges</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">ob_charge_model</span><span class="o">.</span><span class="n">GetPartialCharges</span><span class="p">())</span>

    <span class="n">ppdb</span> <span class="o">=</span> <span class="n">PandasPdb</span><span class="p">()</span>
    <span class="n">ppdb</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span>

    <span class="c1"># Set up dict</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">ChargeData</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;charge_method&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">residue</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;residue_number&quot;</span><span class="p">)):</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">charges</span><span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">residue</span><span class="p">[</span><span class="s2">&quot;atom_number&quot;</span><span class="p">])])</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;charge_method&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.protein_structure.calculate_cysteine_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_cysteine_data</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.calculate_cysteine_data" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Calculates spatial data for a protein from a PDB file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pdb_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the PDB file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>CysteineData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.cysteine_data.CysteineData" href="#procaliper.protein_structure.cysteine_data.CysteineData">CysteineData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A data class for holding size data from computed from a PDB file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/cysteine_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_cysteine_data</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CysteineData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates spatial data for a protein from a PDB file.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdb_filename (str): The path to the PDB file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        CysteineData: A data class for holding size data from computed from a PDB file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ppdb</span> <span class="o">=</span> <span class="n">PandasPdb</span><span class="p">()</span>
    <span class="n">ppdb</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">CysteineData</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;cys_ratio&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;min_dist_to_closest_sulfur&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;sulfur_closeness_rating_scaled&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="n">total_residue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;residue_number&quot;</span><span class="p">]))</span>

    <span class="n">cys_positions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;residue_name&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CYS&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SG&quot;</span><span class="p">:</span>
                <span class="n">cys_positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;x_coord&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">],</span>
                        <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;y_coord&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">],</span>
                        <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;z_coord&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
    <span class="n">total_cys_sites</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cys_positions</span><span class="p">)</span>

    <span class="n">cys_index</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;residue_number&quot;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;CYS&quot;</span><span class="p">:</span>
            <span class="n">sg_closeness_rating_scaled</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">z_p</span> <span class="o">=</span> <span class="n">cys_positions</span><span class="p">[</span><span class="n">cys_index</span><span class="p">]</span>
            <span class="n">min_distance</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Initialize with a large number</span>

            <span class="n">points_excluding_index</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">cys_positions</span><span class="p">[:</span><span class="n">cys_index</span><span class="p">]</span> <span class="o">+</span> <span class="n">cys_positions</span><span class="p">[</span><span class="n">cys_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points_excluding_index</span><span class="p">:</span>
                <span class="n">x_q</span><span class="p">,</span> <span class="n">y_q</span><span class="p">,</span> <span class="n">z_q</span> <span class="o">=</span> <span class="n">point</span>
                <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">x_p</span> <span class="o">-</span> <span class="n">x_q</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_p</span> <span class="o">-</span> <span class="n">y_q</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">z_p</span> <span class="o">-</span> <span class="n">z_q</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="n">min_distance</span><span class="p">:</span>
                    <span class="n">min_distance</span> <span class="o">=</span> <span class="n">distance</span>
                <span class="n">sg_closeness_rating_scaled</span> <span class="o">+=</span> <span class="mi">10</span> <span class="o">/</span> <span class="p">((</span><span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

            <span class="n">cys_index</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;cys_ratio&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">total_cys_sites</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">total_residue</span><span class="p">))</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;min_dist_to_closest_sulfur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_distance</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;sulfur_closeness_rating_scaled&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sg_closeness_rating_scaled</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;cys_ratio&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;min_dist_to_closest_sulfur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;sulfur_closeness_rating_scaled&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.protein_structure.calculate_sasa" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_sasa</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.calculate_sasa" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the SASA values for all CYS sites in a PDB file.</p>
<p>Uses the ShrakeRupley algorithm implemented in <code>Bio.PDB.SASA.ShrakeRupley</code>
with a probe radius of 1.40 and 100 points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pdb_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the PDB file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>SASAData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.sasa.SASAData" href="#procaliper.protein_structure.sasa.SASAData">SASAData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A data class for holding SASA data from computed from a PDB
file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/sasa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_sasa</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SASAData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the SASA values for all CYS sites in a PDB file.</span>

<span class="sd">    Uses the ShrakeRupley algorithm implemented in `Bio.PDB.SASA.ShrakeRupley`</span>
<span class="sd">    with a probe radius of 1.40 and 100 points.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdb_filename (str): The path to the PDB file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SASAData: A data class for holding SASA data from computed from a PDB</span>
<span class="sd">            file.&quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">QUIET</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">struct</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">pdb_filename</span><span class="p">)</span>

    <span class="n">sr</span> <span class="o">=</span> <span class="n">ShrakeRupley</span><span class="p">(</span><span class="n">probe_radius</span><span class="o">=</span><span class="n">PROBE_RADIUS</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="n">N_POINTS</span><span class="p">,</span> <span class="n">radii_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Calc sasa values from Residues (from atoms)</span>
    <span class="n">sr</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;R&quot;</span><span class="p">)</span>

    <span class="c1"># Set up dict</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">SASAData</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;all_sasa_value&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;atom_sasa_values&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="n">Structure</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">struct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="c1"># Fill dict with CYS sites</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">struct</span><span class="o">.</span><span class="n">child_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">child_list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">y</span><span class="o">.</span><span class="n">child_list</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="s2">&quot;sasa&quot;</span><span class="p">)</span>
                <span class="n">res</span><span class="p">[</span><span class="s2">&quot;all_sasa_value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">sasa</span><span class="p">)</span>
                <span class="n">res</span><span class="p">[</span><span class="s2">&quot;atom_sasa_values&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">zx</span><span class="o">.</span><span class="n">sasa</span> <span class="k">for</span> <span class="n">zx</span> <span class="ow">in</span> <span class="n">z</span><span class="o">.</span><span class="n">child_list</span><span class="p">])</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.protein_structure.residue_pLDDT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">residue_pLDDT</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.residue_pLDDT" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Extracts the pLDDT confidence for each residue in a PDB file.</p>
<p>We assume that the pLDDT confidences are in the B-factor entries of the PDB
file. If this information is provided at the atom-level, the maximimum value
across the residue is used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pdb_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the PDB file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[float]: The pLDDT confidence for each residue in the PDB file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/confidence.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">residue_pLDDT</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the pLDDT confidence for each residue in a PDB file.</span>

<span class="sd">    We assume that the pLDDT confidences are in the B-factor entries of the PDB</span>
<span class="sd">    file. If this information is provided at the atom-level, the maximimum value</span>
<span class="sd">    across the residue is used.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdb_filename (str): The path to the PDB file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[float]: The pLDDT confidence for each residue in the PDB file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ppdb</span> <span class="o">=</span> <span class="n">PandasPdb</span><span class="p">()</span>
    <span class="n">ppdb</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span>

    <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;residue_number&quot;</span><span class="p">):</span>
        <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;b_factor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">vals</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>


<div class="doc doc-object doc-module">



<h3 id="procaliper.protein_structure.charge" class="doc doc-heading">
            <code>charge</code>


<a href="#procaliper.protein_structure.charge" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="procaliper.protein_structure.charge.ChargeData" class="doc doc-heading">
            <code>ChargeData</code>


<a href="#procaliper.protein_structure.charge.ChargeData" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>


        <p>A data class for holding charge data from computed from a PDB file.</p>
<p>Array index corresponds to residue number in the PDB. Note that Python
arrays are 0-indexed and PDB files are 1-indexed, so Python index 0
corresponds to residue 1.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.charge.ChargeData.charges">charges</span></code></td>
            <td>
                  <code>list[list[float]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The charge value for atoms in the residue,
ordered from C-terminus to N-terminus according to standard pdb order.
For example, in CYS, the last atom is always the SG sulfur.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.charge.ChargeData.method">method</span></code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method used for the charge calculation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.charge.ChargeData.residue_number">residue_number</span></code></td>
            <td>
                  <code>list[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The residue number for the site.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.charge.ChargeData.residue_name">residue_name</span></code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The residue name (three-letter amino acid
abbreviation) for the sites.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>procaliper/protein_structure/charge.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChargeData</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A data class for holding charge data from computed from a PDB file.</span>

<span class="sd">    Array index corresponds to residue number in the PDB. Note that Python</span>
<span class="sd">    arrays are 0-indexed and PDB files are 1-indexed, so Python index 0</span>
<span class="sd">    corresponds to residue 1.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        charges (list[list[float]]): The charge value for atoms in the residue,</span>
<span class="sd">            ordered from C-terminus to N-terminus according to standard pdb order.</span>
<span class="sd">            For example, in CYS, the last atom is always the SG sulfur.</span>
<span class="sd">        method (list[str]): The method used for the charge calculation.</span>
<span class="sd">        residue_number (list[int]): The residue number for the site.</span>
<span class="sd">        residue_name (list[str]): The residue name (three-letter amino acid</span>
<span class="sd">            abbreviation) for the sites.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">charge</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
    <span class="n">charge_method</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.charge.calculate_charge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_charge</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gasteiger&#39;</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.charge.calculate_charge" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Computes the charge of residue sites in a PDB file.</p>
<p>By default, the method used is 'gasteiger', but this is configurable in
<code>hyperparameters.py</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pdb_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the PDB file. shortname (str): The
shortname of the protein (typically will be UniProt ID).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>method</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method used for the charge calculation.
Examples include 'qtpie', 'eem', 'gasteiger'. Defaults to
'gasteiger'. For a full list reference
https://open-babel.readthedocs.io/en/latest/Charges/charges.html</p>
              </div>
            </td>
            <td>
                  <code>&#39;gasteiger&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the charge method is not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ChargeData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.charge.ChargeData" href="#procaliper.protein_structure.charge.ChargeData">ChargeData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A data class for holding charge data from computed from a
PDB file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/charge.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_charge</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gasteiger&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChargeData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the charge of residue sites in a PDB file.</span>

<span class="sd">    By default, the method used is &#39;gasteiger&#39;, but this is configurable in</span>
<span class="sd">    `hyperparameters.py`.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdb_filename (str): The path to the PDB file. shortname (str): The</span>
<span class="sd">            shortname of the protein (typically will be UniProt ID).</span>
<span class="sd">        method (str, optional): The method used for the charge calculation.</span>
<span class="sd">            Examples include &#39;qtpie&#39;, &#39;eem&#39;, &#39;gasteiger&#39;. Defaults to</span>
<span class="sd">            &#39;gasteiger&#39;. For a full list reference</span>
<span class="sd">            https://open-babel.readthedocs.io/en/latest/Charges/charges.html</span>


<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the charge method is not found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ChargeData: A data class for holding charge data from computed from a</span>
<span class="sd">            PDB file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pbmol</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">pybel</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="n">pdb_filename</span><span class="p">))</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">pbmol</span><span class="o">.</span><span class="n">OBMol</span>

    <span class="c1"># Applies the model and computes charges.</span>
    <span class="n">ob_charge_model</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBChargeModel</span><span class="o">.</span><span class="n">FindType</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ob_charge_model</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Charge method not found. Please check hyperparameters.py&quot;</span><span class="p">)</span>
    <span class="n">ob_charge_model</span><span class="o">.</span><span class="n">ComputeCharges</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">charges</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">ob_charge_model</span><span class="o">.</span><span class="n">GetPartialCharges</span><span class="p">())</span>

    <span class="n">ppdb</span> <span class="o">=</span> <span class="n">PandasPdb</span><span class="p">()</span>
    <span class="n">ppdb</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span>

    <span class="c1"># Set up dict</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">ChargeData</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;charge_method&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">residue</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;residue_number&quot;</span><span class="p">)):</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">charges</span><span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">residue</span><span class="p">[</span><span class="s2">&quot;atom_number&quot;</span><span class="p">])])</span>
        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;charge_method&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="procaliper.protein_structure.confidence" class="doc doc-heading">
            <code>confidence</code>


<a href="#procaliper.protein_structure.confidence" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.confidence.residue_pLDDT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">residue_pLDDT</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.confidence.residue_pLDDT" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Extracts the pLDDT confidence for each residue in a PDB file.</p>
<p>We assume that the pLDDT confidences are in the B-factor entries of the PDB
file. If this information is provided at the atom-level, the maximimum value
across the residue is used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pdb_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the PDB file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[float]: The pLDDT confidence for each residue in the PDB file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/confidence.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">residue_pLDDT</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the pLDDT confidence for each residue in a PDB file.</span>

<span class="sd">    We assume that the pLDDT confidences are in the B-factor entries of the PDB</span>
<span class="sd">    file. If this information is provided at the atom-level, the maximimum value</span>
<span class="sd">    across the residue is used.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdb_filename (str): The path to the PDB file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[float]: The pLDDT confidence for each residue in the PDB file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ppdb</span> <span class="o">=</span> <span class="n">PandasPdb</span><span class="p">()</span>
    <span class="n">ppdb</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span>

    <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;residue_number&quot;</span><span class="p">):</span>
        <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;b_factor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">vals</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="procaliper.protein_structure.cysteine_data" class="doc doc-heading">
            <code>cysteine_data</code>


<a href="#procaliper.protein_structure.cysteine_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="procaliper.protein_structure.cysteine_data.CysteineData" class="doc doc-heading">
            <code>CysteineData</code>


<a href="#procaliper.protein_structure.cysteine_data.CysteineData" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>


        <p>Data class for holding size data from computed from a PDB file.</p>
<p>Non-CYS sites are assigned <code>None</code> values.</p>
<p>Array index corresponds to residue number in the PDB. Note that Python
arrays are 0-indexed and PDB files are 1-indexed, so Python index 0
corresponds to residue 1.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.cysteine_data.CysteineData.cys_ratio">cys_ratio</span></code></td>
            <td>
                  <code>list[float | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ratio of CYS sites to total sites.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.cysteine_data.CysteineData.min_dist_to_closest_sulfur">min_dist_to_closest_sulfur</span></code></td>
            <td>
                  <code>list[float | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum distance to the closest sulfur for each CYS site.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.cysteine_data.CysteineData.sulfur_closeness_rating_scaled">sulfur_closeness_rating_scaled</span></code></td>
            <td>
                  <code>list[float | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sulfur closeness rating scaled for the CYS sites.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>procaliper/protein_structure/cysteine_data.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CysteineData</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Data class for holding size data from computed from a PDB file.</span>

<span class="sd">    Non-CYS sites are assigned `None` values.</span>

<span class="sd">    Array index corresponds to residue number in the PDB. Note that Python</span>
<span class="sd">    arrays are 0-indexed and PDB files are 1-indexed, so Python index 0</span>
<span class="sd">    corresponds to residue 1.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        cys_ratio (list[float | None]): The ratio of CYS sites to total sites.</span>
<span class="sd">        min_dist_to_closest_sulfur (list[float | None]): The minimum distance to the closest sulfur for each CYS site.</span>
<span class="sd">        sulfur_closeness_rating_scaled (list[float | None]): The sulfur closeness rating scaled for the CYS sites.&quot;&quot;&quot;</span>

    <span class="n">cys_ratio</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">min_dist_to_closest_sulfur</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">sulfur_closeness_rating_scaled</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.cysteine_data.calculate_cysteine_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_cysteine_data</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.cysteine_data.calculate_cysteine_data" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculates spatial data for a protein from a PDB file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pdb_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the PDB file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>CysteineData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.cysteine_data.CysteineData" href="#procaliper.protein_structure.cysteine_data.CysteineData">CysteineData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A data class for holding size data from computed from a PDB file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/cysteine_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_cysteine_data</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CysteineData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates spatial data for a protein from a PDB file.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdb_filename (str): The path to the PDB file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        CysteineData: A data class for holding size data from computed from a PDB file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ppdb</span> <span class="o">=</span> <span class="n">PandasPdb</span><span class="p">()</span>
    <span class="n">ppdb</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">CysteineData</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;cys_ratio&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;min_dist_to_closest_sulfur&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;sulfur_closeness_rating_scaled&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="n">total_residue</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;residue_number&quot;</span><span class="p">]))</span>

    <span class="n">cys_positions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;residue_name&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CYS&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;atom_name&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SG&quot;</span><span class="p">:</span>
                <span class="n">cys_positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;x_coord&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">],</span>
                        <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;y_coord&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">],</span>
                        <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">][</span><span class="s2">&quot;z_coord&quot;</span><span class="p">][</span><span class="n">x</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
    <span class="n">total_cys_sites</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cys_positions</span><span class="p">)</span>

    <span class="n">cys_index</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;residue_number&quot;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">grp</span><span class="p">[</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;CYS&quot;</span><span class="p">:</span>
            <span class="n">sg_closeness_rating_scaled</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">z_p</span> <span class="o">=</span> <span class="n">cys_positions</span><span class="p">[</span><span class="n">cys_index</span><span class="p">]</span>
            <span class="n">min_distance</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Initialize with a large number</span>

            <span class="n">points_excluding_index</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">cys_positions</span><span class="p">[:</span><span class="n">cys_index</span><span class="p">]</span> <span class="o">+</span> <span class="n">cys_positions</span><span class="p">[</span><span class="n">cys_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points_excluding_index</span><span class="p">:</span>
                <span class="n">x_q</span><span class="p">,</span> <span class="n">y_q</span><span class="p">,</span> <span class="n">z_q</span> <span class="o">=</span> <span class="n">point</span>
                <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">x_p</span> <span class="o">-</span> <span class="n">x_q</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_p</span> <span class="o">-</span> <span class="n">y_q</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">z_p</span> <span class="o">-</span> <span class="n">z_q</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="n">min_distance</span><span class="p">:</span>
                    <span class="n">min_distance</span> <span class="o">=</span> <span class="n">distance</span>
                <span class="n">sg_closeness_rating_scaled</span> <span class="o">+=</span> <span class="mi">10</span> <span class="o">/</span> <span class="p">((</span><span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

            <span class="n">cys_index</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;cys_ratio&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">total_cys_sites</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">total_residue</span><span class="p">))</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;min_dist_to_closest_sulfur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_distance</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;sulfur_closeness_rating_scaled&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sg_closeness_rating_scaled</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;cys_ratio&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;min_dist_to_closest_sulfur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;sulfur_closeness_rating_scaled&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="procaliper.protein_structure.distance" class="doc doc-heading">
            <code>distance</code>


<a href="#procaliper.protein_structure.distance" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.distance.contact_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contact_map</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">max_dist_angsrtom</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.distance.contact_map" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>A contact map for a protein structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>structure</code></td>
            <td>
                  <code><span title="Bio.PDB.Structure.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>protein structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_dist_angsrtom</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Largest distance to consider a contact,
in Angstroms. Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.int8">int8</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>npt.NDArray[np.float64]: contact map with shape nxn where n is the
number of residues in the structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/distance.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contact_map</span><span class="p">(</span>
    <span class="n">structure</span><span class="p">:</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">max_dist_angsrtom</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A contact map for a protein structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        structure (Structure): protein structure.</span>
<span class="sd">        max_dist_angsrtom (float, optional): Largest distance to consider a contact,</span>
<span class="sd">            in Angstroms. Defaults to 10.</span>

<span class="sd">    Returns:</span>
<span class="sd">        npt.NDArray[np.float64]: contact map with shape nxn where n is the</span>
<span class="sd">            number of residues in the structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">structure</span> <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">model</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">]</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">residues</span><span class="p">))</span>
    <span class="n">adj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>

    <span class="c1"># a residue has zero distance to itself</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)):</span>
        <span class="n">adj</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">r1</span><span class="p">),</span> <span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">residues</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">residue_distance</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="o">&lt;=</span> <span class="n">max_dist_angsrtom</span><span class="p">:</span>
            <span class="n">adj</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">adj</span><span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">adj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.distance.distance_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">distance_matrix</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.distance.distance_matrix" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute a distance matrix for a protein structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>structure</code></td>
            <td>
                  <code><span title="Bio.PDB.Structure.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>protein structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>thresh</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>threshold for distance. Defaults to np.inf.
Distances greater than this will be set to np.inf.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.inf">inf</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>npt.NDArray[np.float64]: distance matrix with shape nxn where n is the
number of residues in the structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/distance.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">distance_matrix</span><span class="p">(</span>
    <span class="n">structure</span><span class="p">:</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">thresh</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a distance matrix for a protein structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        structure (Structure): protein structure.</span>
<span class="sd">        thresh (float, optional): threshold for distance. Defaults to np.inf.</span>
<span class="sd">            Distances greater than this will be set to np.inf.</span>

<span class="sd">    Returns:</span>
<span class="sd">        npt.NDArray[np.float64]: distance matrix with shape nxn where n is the</span>
<span class="sd">            number of residues in the structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">structure</span> <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">model</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">]</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">residues</span><span class="p">))</span>
    <span class="n">adj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

    <span class="c1"># a residue has zero distance to itself</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)):</span>
        <span class="n">adj</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">r1</span><span class="p">),</span> <span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">residues</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">residue_distance</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dist</span> <span class="o">&lt;=</span> <span class="n">thresh</span><span class="p">:</span>
            <span class="n">adj</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span>
            <span class="n">adj</span><span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">adj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.distance.proximity_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">proximity_matrix</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.distance.proximity_matrix" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute a proximity matrix for a protein structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>structure</code></td>
            <td>
                  <code><span title="Bio.PDB.Structure.Structure">Structure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>protein structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>thresh</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>threshold for proximity. Defaults to 0. Proximity
less than this will be set to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>npt.NDArray[np.float64]: proximity matrix with shape nxn where n is the
number of residues in the structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/distance.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">proximity_matrix</span><span class="p">(</span>
    <span class="n">structure</span><span class="p">:</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">thresh</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a proximity matrix for a protein structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        structure (Structure): protein structure.</span>
<span class="sd">        thresh (float, optional): threshold for proximity. Defaults to 0. Proximity</span>
<span class="sd">            less than this will be set to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        npt.NDArray[np.float64]: proximity matrix with shape nxn where n is the</span>
<span class="sd">            number of residues in the structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">structure</span> <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">model</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">]</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">residues</span><span class="p">))</span>
    <span class="n">adj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)))</span>

    <span class="c1"># a residue has proximity 1 to itself</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)):</span>
        <span class="n">adj</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">r1</span><span class="p">),</span> <span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">residues</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">prox</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">residue_distance</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prox</span> <span class="o">&gt;=</span> <span class="n">thresh</span><span class="p">:</span>
            <span class="n">adj</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">prox</span>
            <span class="n">adj</span><span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">adj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.distance.region_distance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">region_distance</span><span class="p">(</span><span class="n">region_1</span><span class="p">,</span> <span class="n">region_2</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.distance.region_distance" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the distance between two regions of a protein, in Angstroms.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>region_1</code></td>
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="Bio.PDB.Residue.Residue">Residue</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>first region.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>region_2</code></td>
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="Bio.PDB.Residue.Residue">Residue</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>second region.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.floating">floating</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.floating[Any]: minimum distance between the two regions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/distance.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">region_distance</span><span class="p">(</span>
    <span class="n">region_1</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Residue</span><span class="p">],</span> <span class="n">region_2</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the distance between two regions of a protein, in Angstroms.</span>

<span class="sd">    Args:</span>
<span class="sd">        region_1 (Iterable[Residue]): first region.</span>
<span class="sd">        region_2 (Iterable[Residue]): second region.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.floating[Any]: minimum distance between the two regions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">residue_distance</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="k">for</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="n">region_1</span><span class="p">,</span> <span class="n">region_2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.distance.region_distance_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">region_distance_matrix</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.distance.region_distance_matrix" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute a distance matrix between regions of a protein.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>regions</code></td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="collections.abc.Iterable">Iterable</span>[<span title="Bio.PDB.Residue.Residue">Residue</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>sequence of regions; each region is an iterable of residues.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>npt.NDArray[np.float64]: distance matrix with shape nxn where n is the
number of regions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/distance.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">region_distance_matrix</span><span class="p">(</span>
    <span class="n">regions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Residue</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a distance matrix between regions of a protein.</span>

<span class="sd">    Args:</span>
<span class="sd">        regions (Sequence[Iterable[Residue]]): sequence of regions; each region is an iterable of residues.</span>

<span class="sd">    Returns:</span>
<span class="sd">        npt.NDArray[np.float64]: distance matrix with shape nxn where n is the</span>
<span class="sd">            number of regions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">region_distance</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="k">for</span> <span class="n">r2</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">]</span> <span class="k">for</span> <span class="n">r1</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.distance.region_proximity_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">region_proximity_matrix</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.distance.region_proximity_matrix" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute a proxmity matrix between regions of a protein.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>regions</code></td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="collections.abc.Iterable">Iterable</span>[<span title="Bio.PDB.Residue.Residue">Residue</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>sequence of regions; each region is an iterable of residues.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>npt.NDArray[np.float64]: proxmity matrix with shape nxn where n is the
number of regions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/distance.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">region_proximity_matrix</span><span class="p">(</span>
    <span class="n">regions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Residue</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a proxmity matrix between regions of a protein.</span>

<span class="sd">    Args:</span>
<span class="sd">        regions (Sequence[Iterable[Residue]]): sequence of regions; each region is an iterable of residues.</span>

<span class="sd">    Returns:</span>
<span class="sd">        npt.NDArray[np.float64]: proxmity matrix with shape nxn where n is the</span>
<span class="sd">            number of regions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">region_distance</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="k">for</span> <span class="n">r2</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">]</span> <span class="k">for</span> <span class="n">r1</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">])</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.distance.residue_distance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">residue_distance</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.distance.residue_distance" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the distance between two residues, in Angstroms.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>r1</code></td>
            <td>
                  <code><span title="Bio.PDB.Residue.Residue">Residue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>first residue.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>r2</code></td>
            <td>
                  <code><span title="Bio.PDB.Residue.Residue">Residue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>second residue.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.floating">floating</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.floating[Any]: distance between the two residues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/distance.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">residue_distance</span><span class="p">(</span>
    <span class="n">r1</span><span class="p">:</span> <span class="n">Residue</span><span class="p">,</span>
    <span class="n">r2</span><span class="p">:</span> <span class="n">Residue</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the distance between two residues, in Angstroms.</span>

<span class="sd">    Args:</span>
<span class="sd">        r1 (Residue): first residue.</span>
<span class="sd">        r2 (Residue): second residue.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.floating[Any]: distance between the two residues.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="n">r1</span><span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span> <span class="o">-</span> <span class="n">r2</span><span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dv</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="procaliper.protein_structure.sasa" class="doc doc-heading">
            <code>sasa</code>


<a href="#procaliper.protein_structure.sasa" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="procaliper.protein_structure.sasa.SASAData" class="doc doc-heading">
            <code>SASAData</code>


<a href="#procaliper.protein_structure.sasa.SASAData" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>


        <p>Data class for holding SASA data from computed from a PDB file.</p>
<p>Array index corresponds to residue number in the PDB. Note that Python
arrays are 0-indexed and PDB files are 1-indexed, so Python index 0
corresponds to residue 1.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.sasa.SASAData.all_sasa_value">all_sasa_value</span></code></td>
            <td>
                  <code>list[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The overall SASA value for each site
(computed as sum of atom SASA values).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.sasa.SASAData.atom_sasa_values">atom_sasa_values</span></code></td>
            <td>
                  <code>list[list[float]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SASA value for the each atom
in each sites. Atoms are ordered from C-terminus to N-terminus
according to standard pdb order. For example, in CYS, the last atom
is always the SG sulfur.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>procaliper/protein_structure/sasa.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SASAData</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Data class for holding SASA data from computed from a PDB file.</span>

<span class="sd">    Array index corresponds to residue number in the PDB. Note that Python</span>
<span class="sd">    arrays are 0-indexed and PDB files are 1-indexed, so Python index 0</span>
<span class="sd">    corresponds to residue 1.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        all_sasa_value (list[float]): The overall SASA value for each site</span>
<span class="sd">            (computed as sum of atom SASA values).</span>
<span class="sd">        atom_sasa_values (list[list[float]]): The SASA value for the each atom</span>
<span class="sd">            in each sites. Atoms are ordered from C-terminus to N-terminus</span>
<span class="sd">            according to standard pdb order. For example, in CYS, the last atom</span>
<span class="sd">            is always the SG sulfur.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">all_sasa_value</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">atom_sasa_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.sasa.calculate_sasa" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_sasa</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.sasa.calculate_sasa" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the SASA values for all CYS sites in a PDB file.</p>
<p>Uses the ShrakeRupley algorithm implemented in <code>Bio.PDB.SASA.ShrakeRupley</code>
with a probe radius of 1.40 and 100 points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pdb_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the PDB file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>SASAData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.sasa.SASAData" href="#procaliper.protein_structure.sasa.SASAData">SASAData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A data class for holding SASA data from computed from a PDB
file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/sasa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_sasa</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SASAData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the SASA values for all CYS sites in a PDB file.</span>

<span class="sd">    Uses the ShrakeRupley algorithm implemented in `Bio.PDB.SASA.ShrakeRupley`</span>
<span class="sd">    with a probe radius of 1.40 and 100 points.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdb_filename (str): The path to the PDB file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SASAData: A data class for holding SASA data from computed from a PDB</span>
<span class="sd">            file.&quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">QUIET</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">struct</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">pdb_filename</span><span class="p">)</span>

    <span class="n">sr</span> <span class="o">=</span> <span class="n">ShrakeRupley</span><span class="p">(</span><span class="n">probe_radius</span><span class="o">=</span><span class="n">PROBE_RADIUS</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="n">N_POINTS</span><span class="p">,</span> <span class="n">radii_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Calc sasa values from Residues (from atoms)</span>
    <span class="n">sr</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;R&quot;</span><span class="p">)</span>

    <span class="c1"># Set up dict</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">SASAData</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;all_sasa_value&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;atom_sasa_values&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="n">Structure</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">struct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="c1"># Fill dict with CYS sites</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">struct</span><span class="o">.</span><span class="n">child_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">child_list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">y</span><span class="o">.</span><span class="n">child_list</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="s2">&quot;sasa&quot;</span><span class="p">)</span>
                <span class="n">res</span><span class="p">[</span><span class="s2">&quot;all_sasa_value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">sasa</span><span class="p">)</span>
                <span class="n">res</span><span class="p">[</span><span class="s2">&quot;atom_sasa_values&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">zx</span><span class="o">.</span><span class="n">sasa</span> <span class="k">for</span> <span class="n">zx</span> <span class="ow">in</span> <span class="n">z</span><span class="o">.</span><span class="n">child_list</span><span class="p">])</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="procaliper.protein_structure.titration" class="doc doc-heading">
            <code>titration</code>


<a href="#procaliper.protein_structure.titration" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="procaliper.protein_structure.titration.TitrationData" class="doc doc-heading">
            <code>TitrationData</code>


<a href="#procaliper.protein_structure.titration.TitrationData" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>


        <p>Data class for titration data.</p>
<p>Array index corresponds to residue number in the PDB. Note that Python
arrays are 0-indexed and PDB files are 1-indexed, so Python index 0
corresponds to residue 1.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.titration.TitrationData.pKa">pKa</span></code></td>
            <td>
                  <code>list[float | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pKa values for the titration data.
Non-titratable sites are assigned <code>None</code> values. protonation_state</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.protein_structure.titration.TitrationData.(list[tuple[str,">(list[tuple[str,</span></code></td>
            <td>
                  <code>float]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The expected protonation states for the
titration data. The first element of the tuple is the state of the
site and the second element is the average protonation of the site.
Non-titratable sites are assigned <code>("undefined", nan)</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>procaliper/protein_structure/titration.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TitrationData</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Data class for titration data.</span>

<span class="sd">    Array index corresponds to residue number in the PDB. Note that Python</span>
<span class="sd">    arrays are 0-indexed and PDB files are 1-indexed, so Python index 0</span>
<span class="sd">    corresponds to residue 1.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        pKa (list[float | None]): The pKa values for the titration data.</span>
<span class="sd">            Non-titratable sites are assigned `None` values. protonation_state</span>
<span class="sd">        (list[tuple[str, float]]): The expected protonation states for the</span>
<span class="sd">            titration data. The first element of the tuple is the state of the</span>
<span class="sd">            site and the second element is the average protonation of the site.</span>
<span class="sd">            Non-titratable sites are assigned `(&quot;undefined&quot;, nan)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pKa</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">protonation_state</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="procaliper.protein_structure.titration.calculate_titration_propka" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_titration_propka</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span></code>

<a href="#procaliper.protein_structure.titration.calculate_titration_propka" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Uses propka to calculate titration data for the protein.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pdb_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the PDB file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TitrationData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.protein_structure.titration.TitrationData" href="#procaliper.protein_structure.titration.TitrationData">TitrationData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The titration data for the protein.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/protein_structure/titration.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_titration_propka</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TitrationData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uses propka to calculate titration data for the protein.</span>

<span class="sd">    Args:</span>
<span class="sd">        pdb_filename (str): The path to the PDB file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TitrationData: The titration data for the protein.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">propka</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">single</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">,</span> <span class="n">optargs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;--quiet&quot;</span><span class="p">],</span> <span class="n">write_pka</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">conformations</span><span class="p">[</span><span class="s2">&quot;AVR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groups</span>

    <span class="n">ppdb</span> <span class="o">=</span> <span class="n">PandasPdb</span><span class="p">()</span>
    <span class="n">ppdb</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">pdb_filename</span><span class="p">)</span>

    <span class="n">seq</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">i</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;residue_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">ppdb</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ATOM&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;residue_number&quot;</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">pks</span> <span class="o">=</span> <span class="p">{</span><span class="n">group</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">res_num</span><span class="p">:</span> <span class="n">group</span><span class="o">.</span><span class="n">pka_value</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">gs</span><span class="p">}</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">TitrationData</span><span class="p">(</span>
        <span class="c1"># pKa=[group.pka_value for group in gs],</span>
        <span class="n">pKa</span><span class="o">=</span><span class="p">[</span><span class="n">pks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pks</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sv</span><span class="p">],</span>
        <span class="n">protonation_state</span><span class="o">=</span><span class="p">[</span><span class="n">_state_from_pk</span><span class="p">(</span><span class="n">pks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pks</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sv</span><span class="p">],</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="procaliper.site_metadata" class="doc doc-heading">
            <code>site_metadata</code>


<a href="#procaliper.site_metadata" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="procaliper.site_metadata.CustomSiteData" class="doc doc-heading">
            <code>CustomSiteData</code>


<a href="#procaliper.site_metadata.CustomSiteData" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>Class for storing custom site-level data.</p>

              <details class="quote">
                <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CustomSiteData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for storing custom site-level data.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="n">residue_number</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;residue_number&quot;</span><span class="p">}</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span>
        <span class="n">residue_index_feature_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;residue_number&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CustomSiteData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a CustomSiteData object from a dictionary of data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (dict[str, list[Any]]): Data dictionary indexed by feature</span>
<span class="sd">                name. Each value must be a list of the same length as the</span>
<span class="sd">                residue number feature. Must include a residue number key.</span>
<span class="sd">            residue_index_feature_name (str, optional): The name of the feature</span>
<span class="sd">                that contains the residue number. Defaults to &quot;residue_number&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the residue number feature is not in the data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CustomSiteData: A CustomSiteData object. that contains the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">residue_index_feature_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CustomSiteData must have a residue_number key.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">residue_index_feature_name</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the data in the CustomSiteData object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[str, list[Any]]: A dictionary of the data in the CustomSiteData</span>
<span class="sd">                object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_residue_numbers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Specify the number of residues in the CustomSiteData object.</span>

<span class="sd">        Args:</span>
<span class="sd">            residue_number (list[int] | int): If an integer, the number of</span>
<span class="sd">                residues. If a list of integers, the list of residue numbers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">residue_number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">residue_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="n">residue_number</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_site_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a site-level feature to the CustomSiteData object.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The name of the feature to add.</span>
<span class="sd">            row (list[Any]): The values for the feature.</span>

<span class="sd">            overwrite (bool, optional): Whether to overwrite an existing</span>
<span class="sd">                feature. Defaults to False.</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: If overwrite is False and the feature already exists.</span>
<span class="sd">            ValueError: If the number of values in the feature does not match</span>
<span class="sd">                the number of residues.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;CustomSiteData already has a </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> key and overwrite is False.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;CustomSiteData has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">)</span><span class="si">}</span><span class="s2"> residues, but </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="si">}</span><span class="s2"> values.&quot;</span>
                <span class="s2">&quot; Perhaps you forgot to call add_residue_numbers?&quot;</span>
            <span class="p">)</span>

        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="procaliper.site_metadata.CustomSiteData.add_residue_numbers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_residue_numbers</span><span class="p">(</span><span class="n">residue_number</span><span class="p">)</span></code>

<a href="#procaliper.site_metadata.CustomSiteData.add_residue_numbers" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Specify the number of residues in the CustomSiteData object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>residue_number</code></td>
            <td>
                  <code>list[int] | int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an integer, the number of
residues. If a list of integers, the list of residue numbers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_residue_numbers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specify the number of residues in the CustomSiteData object.</span>

<span class="sd">    Args:</span>
<span class="sd">        residue_number (list[int] | int): If an integer, the number of</span>
<span class="sd">            residues. If a list of integers, the list of residue numbers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">residue_number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">residue_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="n">residue_number</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.site_metadata.CustomSiteData.add_site_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_site_data</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#procaliper.site_metadata.CustomSiteData.add_site_data" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a site-level feature to the CustomSiteData object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>key</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the feature to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>row</code></td>
            <td>
                  <code>list[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The values for the feature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>overwrite</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite an existing
feature. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If overwrite is False and the feature already exists.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the number of values in the feature does not match
the number of residues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_site_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a site-level feature to the CustomSiteData object.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The name of the feature to add.</span>
<span class="sd">        row (list[Any]): The values for the feature.</span>

<span class="sd">        overwrite (bool, optional): Whether to overwrite an existing</span>
<span class="sd">            feature. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If overwrite is False and the feature already exists.</span>
<span class="sd">        ValueError: If the number of values in the feature does not match</span>
<span class="sd">            the number of residues.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;CustomSiteData already has a </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> key and overwrite is False.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;CustomSiteData has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">)</span><span class="si">}</span><span class="s2"> residues, but </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="si">}</span><span class="s2"> values.&quot;</span>
            <span class="s2">&quot; Perhaps you forgot to call add_residue_numbers?&quot;</span>
        <span class="p">)</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.site_metadata.CustomSiteData.from_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">residue_index_feature_name</span><span class="o">=</span><span class="s1">&#39;residue_number&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#procaliper.site_metadata.CustomSiteData.from_dict" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a CustomSiteData object from a dictionary of data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code>dict[str, list[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data dictionary indexed by feature
name. Each value must be a list of the same length as the
residue number feature. Must include a residue number key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>residue_index_feature_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the feature
that contains the residue number. Defaults to "residue_number".</p>
              </div>
            </td>
            <td>
                  <code>&#39;residue_number&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the residue number feature is not in the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>CustomSiteData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.site_metadata.custom_site_data.CustomSiteData" href="#procaliper.site_metadata.custom_site_data.CustomSiteData">CustomSiteData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A CustomSiteData object. that contains the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span>
    <span class="n">residue_index_feature_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;residue_number&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CustomSiteData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a CustomSiteData object from a dictionary of data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict[str, list[Any]]): Data dictionary indexed by feature</span>
<span class="sd">            name. Each value must be a list of the same length as the</span>
<span class="sd">            residue number feature. Must include a residue number key.</span>
<span class="sd">        residue_index_feature_name (str, optional): The name of the feature</span>
<span class="sd">            that contains the residue number. Defaults to &quot;residue_number&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the residue number feature is not in the data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        CustomSiteData: A CustomSiteData object. that contains the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">residue_index_feature_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CustomSiteData must have a residue_number key.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">residue_index_feature_name</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.site_metadata.CustomSiteData.table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">table</span><span class="p">()</span></code>

<a href="#procaliper.site_metadata.CustomSiteData.table" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return a dictionary of the data in the CustomSiteData object.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, list[Any]]: A dictionary of the data in the CustomSiteData
object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the data in the CustomSiteData object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, list[Any]]: A dictionary of the data in the CustomSiteData</span>
<span class="sd">            object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="procaliper.site_metadata.SiteAnnotations" class="doc doc-heading">
            <code>SiteAnnotations</code>


<a href="#procaliper.site_metadata.SiteAnnotations" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>Class for parsing and storing UniProt site annotations.</p>
<p>An example of a UniProt site annotation:</p>
<p><code>DISULFID 28..87; /evidence="ECO:0000255|PROSITE-ProRule:PRU00114"; DISULFID 105; /note="Interchain (with heavy chain)"</code></p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.residue_letter">residue_letter</span></code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of amino acid letters.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.residue_number">residue_number</span></code></td>
            <td>
                  <code>list[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of residue numbers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.binding">binding</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is a binding site.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.active">active</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is an active site.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.ptm">ptm</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is reported to be post-translationally modified.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.dna_binding">dna_binding</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is a DNA binding site.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.disulfide_bond">disulfide_bond</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is a disulfide bond.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.helix">helix</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is in a helix.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.turn">turn</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is in a turn.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.beta_strand">beta_strand</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is in a beta strand.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.binding_data">binding_data</span></code></td>
            <td>
                  <code>list[dict[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries containing
binding site metadata.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.active_data">active_data</span></code></td>
            <td>
                  <code>list[dict[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries containing
active site metadata.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.ptm_data">ptm_data</span></code></td>
            <td>
                  <code>list[dict[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries containing
post-translationally modified site metadata.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.regions">regions</span></code></td>
            <td>
                  <code>dict[str, list[int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping region names to lists
of (zero-indexed) residue numbers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.SiteAnnotations.region_data">region_data</span></code></td>
            <td>
                  <code>dict[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping region names to annotation data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>procaliper/site_metadata/uniprot_site_parsing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SiteAnnotations</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for parsing and storing UniProt site annotations.</span>

<span class="sd">    An example of a UniProt site annotation:</span>

<span class="sd">    `DISULFID 28..87; /evidence=&quot;ECO:0000255|PROSITE-ProRule:PRU00114&quot;; DISULFID 105; /note=&quot;Interchain (with heavy chain)&quot;`</span>

<span class="sd">    Attributes:</span>
<span class="sd">        residue_letter (list[str]): A list of amino acid letters.</span>
<span class="sd">        residue_number (list[int]): A list of residue numbers.</span>
<span class="sd">        binding (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is a binding site.</span>
<span class="sd">        active (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is an active site.</span>
<span class="sd">        ptm (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is reported to be post-translationally modified.</span>
<span class="sd">        dna_binding (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is a DNA binding site.</span>
<span class="sd">        disulfide_bond (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is a disulfide bond.</span>
<span class="sd">        helix (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is in a helix.</span>
<span class="sd">        turn (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is in a turn.</span>
<span class="sd">        beta_strand (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is in a beta strand.</span>
<span class="sd">        binding_data (list[dict[str, str]]): A list of dictionaries containing</span>
<span class="sd">            binding site metadata.</span>
<span class="sd">        active_data (list[dict[str, str]]): A list of dictionaries containing</span>
<span class="sd">            active site metadata.</span>
<span class="sd">        ptm_data (list[dict[str, str]]): A list of dictionaries containing</span>
<span class="sd">            post-translationally modified site metadata.</span>
<span class="sd">        regions (dict[str,list[int]]): A dictionary mapping region names to lists</span>
<span class="sd">            of (zero-indexed) residue numbers.</span>
<span class="sd">        region_data (dict[str,str]): A dictionary mapping region names to annotation data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fields_by_description_type</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;BINDING&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ligand&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ACT_SITE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;note&quot;</span><span class="p">],</span>
        <span class="s2">&quot;MOD_RES&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;note&quot;</span><span class="p">],</span>
        <span class="s2">&quot;REGION&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;note&quot;</span><span class="p">],</span>
        <span class="s2">&quot;DNA_BIND&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;DISULFID&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;HELIX&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;TURN&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;STRAND&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiates a SiteAnnotations object from a string of amino acid letters.</span>

<span class="sd">        It is recommended to call `SiteAnnotations.extract_annotation` after instantiating.</span>
<span class="sd">        Before that, the `SiteAnnotations` object contains only default values.</span>

<span class="sd">        Args:</span>
<span class="sd">            sequence (str): A string of amino acid letters. See</span>
<span class="sd">                `type_aliases.AminoAcidLetter` for valid letters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turn</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">regions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the data in the SiteAnnotations object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[str, list[Any]]: Each key is a site annotation feature name.</span>
<span class="sd">                Each value is a list of the values for that feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tbl</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;residue_letter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;residue_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;binding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;active&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;ptm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;dna_binding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;disulfide_bond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;helix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helix</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;turn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">turn</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;beta_strand&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;binding_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;active_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;ptm_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span>

        <span class="k">return</span> <span class="n">tbl</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_description</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">description_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">extract_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="c1"># example of descrition:</span>
        <span class="c1"># DISULFID 28..87; /evidence=&quot;ECO:0000255|PROSITE-ProRule:PRU00114&quot;; DISULFID 105; /note=&quot;Interchain (with heavy chain)&quot;</span>

        <span class="n">site_matches</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">site_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">extract_metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extract_metadata</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields_by_description_type</span><span class="p">[</span><span class="n">description_type</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">extract_metadata</span><span class="p">:</span>
            <span class="n">site_data</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>

        <span class="k">if</span> <span class="n">description_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields_by_description_type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown description type: </span><span class="si">{</span><span class="n">description_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="n">description</span> <span class="ow">or</span> <span class="n">description</span> <span class="o">!=</span> <span class="n">description</span>
        <span class="p">):</span>  <span class="c1"># not-equal check is for pandas nans</span>
            <span class="k">return</span> <span class="n">site_matches</span><span class="p">,</span> <span class="n">site_data</span>
        <span class="k">if</span> <span class="n">description_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">description</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">description_type</span><span class="si">}</span><span class="s2"> does not appear in the description: </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">stretches</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">description_type</span><span class="p">)</span>

        <span class="c1"># first stretch is always empty</span>
        <span class="k">for</span> <span class="n">stretch</span> <span class="ow">in</span> <span class="n">stretches</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">stretch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
            <span class="c1"># first field is always site numbers</span>
            <span class="n">se</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># uniprot 1-indexes sites</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">or</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">or</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">end</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Improperly formatted descritpion; site numbers not recognized: </span><span class="si">{</span><span class="n">stretch</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="n">field_sites</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">field_sites</span><span class="p">:</span>
                <span class="n">site_matches</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">site_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">field_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields_by_description_type</span><span class="p">[</span><span class="n">description_type</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">field_id</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="n">field_data</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">field_id</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">field_sites</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">field_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">site_data</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
                            <span class="n">site_data</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">field_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_data</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">site_data</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">field_id</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">field_data</span>

        <span class="k">return</span> <span class="n">site_matches</span><span class="p">,</span> <span class="n">site_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_region_parsing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">region_annotations</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;REGION &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">region_index</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">region_annotations</span><span class="p">):</span>
            <span class="n">r</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;r_</span><span class="si">{</span><span class="n">region_index</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">range</span><span class="p">(</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">field_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields_by_description_type</span><span class="p">[</span><span class="s2">&quot;REGION&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">field_id</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="n">field_data</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">field_id</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">field_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">[</span><span class="n">r</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">field_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_data</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">field_id</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">field_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_annotation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">description_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">extract_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extracts the site annotations from the description.</span>

<span class="sd">        Args:</span>
<span class="sd">            description_type (str): The type of site annotation to extract. Must be</span>
<span class="sd">                one of the keys in `self.fields_by_description_type`.</span>
<span class="sd">            description (str): The UniProt site description string.</span>
<span class="sd">            extract_metadata (bool | None, optional): Whether to extract metadata.</span>
<span class="sd">                By default, this is inferred from the `description_type` parameter.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: From `_parse_description`. If an unknown `description_type` is provided.</span>
<span class="sd">            ValueError: From `_parse_description`. If the `description_type` is not found in `description`.</span>
<span class="sd">            AssertionError: If a `description_type` is provided that is known to `_parse_description` but</span>
<span class="sd">                not `extract_annotation`. This indicates an internal bug and should be reported.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># regions are a special case because they can overlap</span>
        <span class="k">if</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;REGION&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_region_parsing</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">matches</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_description</span><span class="p">(</span>
            <span class="n">description_type</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">extract_metadata</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;ACT_SITE&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">matches</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;BINDING&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binding</span> <span class="o">=</span> <span class="n">matches</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;MOD_RES&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span> <span class="o">=</span> <span class="n">matches</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;DNA_BIND&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;DISULFID&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;STRAND&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;HELIX&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helix</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;TURN&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">turn</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;If this is raised, the description type </span><span class="si">{</span><span class="n">description_type</span><span class="si">}</span><span class="s2"> is only partially handled. Please file an issue.&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="procaliper.site_metadata.SiteAnnotations.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span></code>

<a href="#procaliper.site_metadata.SiteAnnotations.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Instantiates a SiteAnnotations object from a string of amino acid letters.</p>
<p>It is recommended to call <code>SiteAnnotations.extract_annotation</code> after instantiating.
Before that, the <code>SiteAnnotations</code> object contains only default values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string of amino acid letters. See
<code>type_aliases.AminoAcidLetter</code> for valid letters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/uniprot_site_parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiates a SiteAnnotations object from a string of amino acid letters.</span>

<span class="sd">    It is recommended to call `SiteAnnotations.extract_annotation` after instantiating.</span>
<span class="sd">    Before that, the `SiteAnnotations` object contains only default values.</span>

<span class="sd">    Args:</span>
<span class="sd">        sequence (str): A string of amino acid letters. See</span>
<span class="sd">            `type_aliases.AminoAcidLetter` for valid letters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">binding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">helix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">turn</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.site_metadata.SiteAnnotations.extract_annotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_annotation</span><span class="p">(</span><span class="n">description_type</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">extract_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#procaliper.site_metadata.SiteAnnotations.extract_annotation" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Extracts the site annotations from the description.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>description_type</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of site annotation to extract. Must be
one of the keys in <code>self.fields_by_description_type</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>description</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The UniProt site description string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>extract_metadata</code></td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to extract metadata.
By default, this is inferred from the <code>description_type</code> parameter.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>NotImplementedError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>From <code>_parse_description</code>. If an unknown <code>description_type</code> is provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>From <code>_parse_description</code>. If the <code>description_type</code> is not found in <code>description</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>AssertionError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a <code>description_type</code> is provided that is known to <code>_parse_description</code> but
not <code>extract_annotation</code>. This indicates an internal bug and should be reported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/uniprot_site_parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_annotation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">description_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">extract_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the site annotations from the description.</span>

<span class="sd">    Args:</span>
<span class="sd">        description_type (str): The type of site annotation to extract. Must be</span>
<span class="sd">            one of the keys in `self.fields_by_description_type`.</span>
<span class="sd">        description (str): The UniProt site description string.</span>
<span class="sd">        extract_metadata (bool | None, optional): Whether to extract metadata.</span>
<span class="sd">            By default, this is inferred from the `description_type` parameter.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: From `_parse_description`. If an unknown `description_type` is provided.</span>
<span class="sd">        ValueError: From `_parse_description`. If the `description_type` is not found in `description`.</span>
<span class="sd">        AssertionError: If a `description_type` is provided that is known to `_parse_description` but</span>
<span class="sd">            not `extract_annotation`. This indicates an internal bug and should be reported.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># regions are a special case because they can overlap</span>
    <span class="k">if</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;REGION&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_region_parsing</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">matches</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_description</span><span class="p">(</span>
        <span class="n">description_type</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">extract_metadata</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;ACT_SITE&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;BINDING&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binding</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;MOD_RES&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;DNA_BIND&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;DISULFID&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;STRAND&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;HELIX&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helix</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;TURN&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turn</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;If this is raised, the description type </span><span class="si">{</span><span class="n">description_type</span><span class="si">}</span><span class="s2"> is only partially handled. Please file an issue.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.site_metadata.SiteAnnotations.table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">table</span><span class="p">()</span></code>

<a href="#procaliper.site_metadata.SiteAnnotations.table" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return a dictionary of the data in the SiteAnnotations object.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, list[Any]]: Each key is a site annotation feature name.
Each value is a list of the values for that feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/uniprot_site_parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the data in the SiteAnnotations object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, list[Any]]: Each key is a site annotation feature name.</span>
<span class="sd">            Each value is a list of the values for that feature.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tbl</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;residue_letter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;residue_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;binding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;active&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;ptm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;dna_binding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;disulfide_bond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;helix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helix</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;turn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">turn</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;beta_strand&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;binding_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;active_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;ptm_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span>

    <span class="k">return</span> <span class="n">tbl</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>



<div class="doc doc-object doc-module">



<h3 id="procaliper.site_metadata.custom_site_data" class="doc doc-heading">
            <code>custom_site_data</code>


<a href="#procaliper.site_metadata.custom_site_data" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="procaliper.site_metadata.custom_site_data.CustomSiteData" class="doc doc-heading">
            <code>CustomSiteData</code>


<a href="#procaliper.site_metadata.custom_site_data.CustomSiteData" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


        <p>Class for storing custom site-level data.</p>

              <details class="quote">
                <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CustomSiteData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for storing custom site-level data.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="n">residue_number</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;residue_number&quot;</span><span class="p">}</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span>
        <span class="n">residue_index_feature_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;residue_number&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CustomSiteData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a CustomSiteData object from a dictionary of data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (dict[str, list[Any]]): Data dictionary indexed by feature</span>
<span class="sd">                name. Each value must be a list of the same length as the</span>
<span class="sd">                residue number feature. Must include a residue number key.</span>
<span class="sd">            residue_index_feature_name (str, optional): The name of the feature</span>
<span class="sd">                that contains the residue number. Defaults to &quot;residue_number&quot;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the residue number feature is not in the data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CustomSiteData: A CustomSiteData object. that contains the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">residue_index_feature_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CustomSiteData must have a residue_number key.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">residue_index_feature_name</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the data in the CustomSiteData object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[str, list[Any]]: A dictionary of the data in the CustomSiteData</span>
<span class="sd">                object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_residue_numbers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Specify the number of residues in the CustomSiteData object.</span>

<span class="sd">        Args:</span>
<span class="sd">            residue_number (list[int] | int): If an integer, the number of</span>
<span class="sd">                residues. If a list of integers, the list of residue numbers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">residue_number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">residue_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="n">residue_number</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_site_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a site-level feature to the CustomSiteData object.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The name of the feature to add.</span>
<span class="sd">            row (list[Any]): The values for the feature.</span>

<span class="sd">            overwrite (bool, optional): Whether to overwrite an existing</span>
<span class="sd">                feature. Defaults to False.</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: If overwrite is False and the feature already exists.</span>
<span class="sd">            ValueError: If the number of values in the feature does not match</span>
<span class="sd">                the number of residues.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;CustomSiteData already has a </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> key and overwrite is False.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;CustomSiteData has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">)</span><span class="si">}</span><span class="s2"> residues, but </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="si">}</span><span class="s2"> values.&quot;</span>
                <span class="s2">&quot; Perhaps you forgot to call add_residue_numbers?&quot;</span>
            <span class="p">)</span>

        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="procaliper.site_metadata.custom_site_data.CustomSiteData.add_residue_numbers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_residue_numbers</span><span class="p">(</span><span class="n">residue_number</span><span class="p">)</span></code>

<a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.add_residue_numbers" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Specify the number of residues in the CustomSiteData object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>residue_number</code></td>
            <td>
                  <code>list[int] | int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an integer, the number of
residues. If a list of integers, the list of residue numbers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_residue_numbers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specify the number of residues in the CustomSiteData object.</span>

<span class="sd">    Args:</span>
<span class="sd">        residue_number (list[int] | int): If an integer, the number of</span>
<span class="sd">            residues. If a list of integers, the list of residue numbers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">residue_number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">residue_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="n">residue_number</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="procaliper.site_metadata.custom_site_data.CustomSiteData.add_site_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_site_data</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.add_site_data" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Add a site-level feature to the CustomSiteData object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>key</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the feature to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>row</code></td>
            <td>
                  <code>list[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The values for the feature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>overwrite</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite an existing
feature. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KeyError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If overwrite is False and the feature already exists.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the number of values in the feature does not match
the number of residues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_site_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a site-level feature to the CustomSiteData object.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The name of the feature to add.</span>
<span class="sd">        row (list[Any]): The values for the feature.</span>

<span class="sd">        overwrite (bool, optional): Whether to overwrite an existing</span>
<span class="sd">            feature. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If overwrite is False and the feature already exists.</span>
<span class="sd">        ValueError: If the number of values in the feature does not match</span>
<span class="sd">            the number of residues.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;CustomSiteData already has a </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> key and overwrite is False.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;CustomSiteData has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">)</span><span class="si">}</span><span class="s2"> residues, but </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="si">}</span><span class="s2"> values.&quot;</span>
            <span class="s2">&quot; Perhaps you forgot to call add_residue_numbers?&quot;</span>
        <span class="p">)</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="procaliper.site_metadata.custom_site_data.CustomSiteData.from_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">residue_index_feature_name</span><span class="o">=</span><span class="s1">&#39;residue_number&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.from_dict" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Create a CustomSiteData object from a dictionary of data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code>dict[str, list[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data dictionary indexed by feature
name. Each value must be a list of the same length as the
residue number feature. Must include a residue number key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>residue_index_feature_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the feature
that contains the residue number. Defaults to "residue_number".</p>
              </div>
            </td>
            <td>
                  <code>&#39;residue_number&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the residue number feature is not in the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>CustomSiteData</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper.site_metadata.custom_site_data.CustomSiteData" href="#procaliper.site_metadata.custom_site_data.CustomSiteData">CustomSiteData</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A CustomSiteData object. that contains the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span>
    <span class="n">residue_index_feature_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;residue_number&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CustomSiteData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a CustomSiteData object from a dictionary of data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict[str, list[Any]]): Data dictionary indexed by feature</span>
<span class="sd">            name. Each value must be a list of the same length as the</span>
<span class="sd">            residue number feature. Must include a residue number key.</span>
<span class="sd">        residue_index_feature_name (str, optional): The name of the feature</span>
<span class="sd">            that contains the residue number. Defaults to &quot;residue_number&quot;.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the residue number feature is not in the data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        CustomSiteData: A CustomSiteData object. that contains the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">residue_index_feature_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;CustomSiteData must have a residue_number key.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">residue_index_feature_name</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="procaliper.site_metadata.custom_site_data.CustomSiteData.table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">table</span><span class="p">()</span></code>

<a href="#procaliper.site_metadata.custom_site_data.CustomSiteData.table" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Return a dictionary of the data in the CustomSiteData object.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, list[Any]]: A dictionary of the data in the CustomSiteData
object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/custom_site_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the data in the CustomSiteData object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, list[Any]]: A dictionary of the data in the CustomSiteData</span>
<span class="sd">            object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="procaliper.site_metadata.uniprot_site_parsing" class="doc doc-heading">
            <code>uniprot_site_parsing</code>


<a href="#procaliper.site_metadata.uniprot_site_parsing" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations" class="doc doc-heading">
            <code>SiteAnnotations</code>


<a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


        <p>Class for parsing and storing UniProt site annotations.</p>
<p>An example of a UniProt site annotation:</p>
<p><code>DISULFID 28..87; /evidence="ECO:0000255|PROSITE-ProRule:PRU00114"; DISULFID 105; /note="Interchain (with heavy chain)"</code></p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.residue_letter">residue_letter</span></code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of amino acid letters.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.residue_number">residue_number</span></code></td>
            <td>
                  <code>list[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of residue numbers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.binding">binding</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is a binding site.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.active">active</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is an active site.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.ptm">ptm</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is reported to be post-translationally modified.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.dna_binding">dna_binding</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is a DNA binding site.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.disulfide_bond">disulfide_bond</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is a disulfide bond.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.helix">helix</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is in a helix.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.turn">turn</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is in a turn.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.beta_strand">beta_strand</span></code></td>
            <td>
                  <code>list[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of booleans indicating whether a residue
is in a beta strand.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.binding_data">binding_data</span></code></td>
            <td>
                  <code>list[dict[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries containing
binding site metadata.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.active_data">active_data</span></code></td>
            <td>
                  <code>list[dict[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries containing
active site metadata.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.ptm_data">ptm_data</span></code></td>
            <td>
                  <code>list[dict[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries containing
post-translationally modified site metadata.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.regions">regions</span></code></td>
            <td>
                  <code>dict[str, list[int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping region names to lists
of (zero-indexed) residue numbers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.region_data">region_data</span></code></td>
            <td>
                  <code>dict[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping region names to annotation data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>procaliper/site_metadata/uniprot_site_parsing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SiteAnnotations</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for parsing and storing UniProt site annotations.</span>

<span class="sd">    An example of a UniProt site annotation:</span>

<span class="sd">    `DISULFID 28..87; /evidence=&quot;ECO:0000255|PROSITE-ProRule:PRU00114&quot;; DISULFID 105; /note=&quot;Interchain (with heavy chain)&quot;`</span>

<span class="sd">    Attributes:</span>
<span class="sd">        residue_letter (list[str]): A list of amino acid letters.</span>
<span class="sd">        residue_number (list[int]): A list of residue numbers.</span>
<span class="sd">        binding (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is a binding site.</span>
<span class="sd">        active (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is an active site.</span>
<span class="sd">        ptm (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is reported to be post-translationally modified.</span>
<span class="sd">        dna_binding (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is a DNA binding site.</span>
<span class="sd">        disulfide_bond (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is a disulfide bond.</span>
<span class="sd">        helix (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is in a helix.</span>
<span class="sd">        turn (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is in a turn.</span>
<span class="sd">        beta_strand (list[bool]): A list of booleans indicating whether a residue</span>
<span class="sd">            is in a beta strand.</span>
<span class="sd">        binding_data (list[dict[str, str]]): A list of dictionaries containing</span>
<span class="sd">            binding site metadata.</span>
<span class="sd">        active_data (list[dict[str, str]]): A list of dictionaries containing</span>
<span class="sd">            active site metadata.</span>
<span class="sd">        ptm_data (list[dict[str, str]]): A list of dictionaries containing</span>
<span class="sd">            post-translationally modified site metadata.</span>
<span class="sd">        regions (dict[str,list[int]]): A dictionary mapping region names to lists</span>
<span class="sd">            of (zero-indexed) residue numbers.</span>
<span class="sd">        region_data (dict[str,str]): A dictionary mapping region names to annotation data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fields_by_description_type</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;BINDING&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ligand&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ACT_SITE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;note&quot;</span><span class="p">],</span>
        <span class="s2">&quot;MOD_RES&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;note&quot;</span><span class="p">],</span>
        <span class="s2">&quot;REGION&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;note&quot;</span><span class="p">],</span>
        <span class="s2">&quot;DNA_BIND&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;DISULFID&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;HELIX&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;TURN&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;STRAND&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiates a SiteAnnotations object from a string of amino acid letters.</span>

<span class="sd">        It is recommended to call `SiteAnnotations.extract_annotation` after instantiating.</span>
<span class="sd">        Before that, the `SiteAnnotations` object contains only default values.</span>

<span class="sd">        Args:</span>
<span class="sd">            sequence (str): A string of amino acid letters. See</span>
<span class="sd">                `type_aliases.AminoAcidLetter` for valid letters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turn</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">regions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the data in the SiteAnnotations object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[str, list[Any]]: Each key is a site annotation feature name.</span>
<span class="sd">                Each value is a list of the values for that feature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tbl</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;residue_letter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;residue_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;binding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;active&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;ptm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;dna_binding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;disulfide_bond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;helix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helix</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;turn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">turn</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;beta_strand&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;binding_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;active_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span>
        <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;ptm_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span>

        <span class="k">return</span> <span class="n">tbl</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_description</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">description_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">extract_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="c1"># example of descrition:</span>
        <span class="c1"># DISULFID 28..87; /evidence=&quot;ECO:0000255|PROSITE-ProRule:PRU00114&quot;; DISULFID 105; /note=&quot;Interchain (with heavy chain)&quot;</span>

        <span class="n">site_matches</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">site_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">extract_metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extract_metadata</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields_by_description_type</span><span class="p">[</span><span class="n">description_type</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">extract_metadata</span><span class="p">:</span>
            <span class="n">site_data</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>

        <span class="k">if</span> <span class="n">description_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields_by_description_type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown description type: </span><span class="si">{</span><span class="n">description_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="n">description</span> <span class="ow">or</span> <span class="n">description</span> <span class="o">!=</span> <span class="n">description</span>
        <span class="p">):</span>  <span class="c1"># not-equal check is for pandas nans</span>
            <span class="k">return</span> <span class="n">site_matches</span><span class="p">,</span> <span class="n">site_data</span>
        <span class="k">if</span> <span class="n">description_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">description</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">description_type</span><span class="si">}</span><span class="s2"> does not appear in the description: </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">stretches</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">description_type</span><span class="p">)</span>

        <span class="c1"># first stretch is always empty</span>
        <span class="k">for</span> <span class="n">stretch</span> <span class="ow">in</span> <span class="n">stretches</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">stretch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
            <span class="c1"># first field is always site numbers</span>
            <span class="n">se</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># uniprot 1-indexes sites</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">or</span> <span class="n">end</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">or</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">end</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Improperly formatted descritpion; site numbers not recognized: </span><span class="si">{</span><span class="n">stretch</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="n">field_sites</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">field_sites</span><span class="p">:</span>
                <span class="n">site_matches</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">site_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">field_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields_by_description_type</span><span class="p">[</span><span class="n">description_type</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">field_id</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="n">field_data</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">field_id</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">field_sites</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">field_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">site_data</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
                            <span class="n">site_data</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">field_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_data</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">site_data</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">field_id</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">field_data</span>

        <span class="k">return</span> <span class="n">site_matches</span><span class="p">,</span> <span class="n">site_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_region_parsing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">region_annotations</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;REGION &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">region_index</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">region_annotations</span><span class="p">):</span>
            <span class="n">r</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;r_</span><span class="si">{</span><span class="n">region_index</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">regions</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">range</span><span class="p">(</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">field_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields_by_description_type</span><span class="p">[</span><span class="s2">&quot;REGION&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">field_id</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="n">field_data</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">field_id</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">field_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">[</span><span class="n">r</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">field_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_data</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">field_id</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">field_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_annotation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">description_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">extract_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extracts the site annotations from the description.</span>

<span class="sd">        Args:</span>
<span class="sd">            description_type (str): The type of site annotation to extract. Must be</span>
<span class="sd">                one of the keys in `self.fields_by_description_type`.</span>
<span class="sd">            description (str): The UniProt site description string.</span>
<span class="sd">            extract_metadata (bool | None, optional): Whether to extract metadata.</span>
<span class="sd">                By default, this is inferred from the `description_type` parameter.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: From `_parse_description`. If an unknown `description_type` is provided.</span>
<span class="sd">            ValueError: From `_parse_description`. If the `description_type` is not found in `description`.</span>
<span class="sd">            AssertionError: If a `description_type` is provided that is known to `_parse_description` but</span>
<span class="sd">                not `extract_annotation`. This indicates an internal bug and should be reported.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># regions are a special case because they can overlap</span>
        <span class="k">if</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;REGION&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_region_parsing</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">matches</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_description</span><span class="p">(</span>
            <span class="n">description_type</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">extract_metadata</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;ACT_SITE&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">matches</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;BINDING&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binding</span> <span class="o">=</span> <span class="n">matches</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;MOD_RES&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span> <span class="o">=</span> <span class="n">matches</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;DNA_BIND&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;DISULFID&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;STRAND&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;HELIX&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helix</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;TURN&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">turn</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;If this is raised, the description type </span><span class="si">{</span><span class="n">description_type</span><span class="si">}</span><span class="s2"> is only partially handled. Please file an issue.&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span></code>

<a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Instantiates a SiteAnnotations object from a string of amino acid letters.</p>
<p>It is recommended to call <code>SiteAnnotations.extract_annotation</code> after instantiating.
Before that, the <code>SiteAnnotations</code> object contains only default values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string of amino acid letters. See
<code>type_aliases.AminoAcidLetter</code> for valid letters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/uniprot_site_parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiates a SiteAnnotations object from a string of amino acid letters.</span>

<span class="sd">    It is recommended to call `SiteAnnotations.extract_annotation` after instantiating.</span>
<span class="sd">    Before that, the `SiteAnnotations` object contains only default values.</span>

<span class="sd">    Args:</span>
<span class="sd">        sequence (str): A string of amino acid letters. See</span>
<span class="sd">            `type_aliases.AminoAcidLetter` for valid letters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">binding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">helix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">turn</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">))]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">region_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.extract_annotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_annotation</span><span class="p">(</span><span class="n">description_type</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">extract_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.extract_annotation" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Extracts the site annotations from the description.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>description_type</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of site annotation to extract. Must be
one of the keys in <code>self.fields_by_description_type</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>description</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The UniProt site description string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>extract_metadata</code></td>
            <td>
                  <code>bool | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to extract metadata.
By default, this is inferred from the <code>description_type</code> parameter.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>NotImplementedError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>From <code>_parse_description</code>. If an unknown <code>description_type</code> is provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>From <code>_parse_description</code>. If the <code>description_type</code> is not found in <code>description</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>AssertionError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a <code>description_type</code> is provided that is known to <code>_parse_description</code> but
not <code>extract_annotation</code>. This indicates an internal bug and should be reported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/uniprot_site_parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_annotation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">description_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">extract_metadata</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the site annotations from the description.</span>

<span class="sd">    Args:</span>
<span class="sd">        description_type (str): The type of site annotation to extract. Must be</span>
<span class="sd">            one of the keys in `self.fields_by_description_type`.</span>
<span class="sd">        description (str): The UniProt site description string.</span>
<span class="sd">        extract_metadata (bool | None, optional): Whether to extract metadata.</span>
<span class="sd">            By default, this is inferred from the `description_type` parameter.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: From `_parse_description`. If an unknown `description_type` is provided.</span>
<span class="sd">        ValueError: From `_parse_description`. If the `description_type` is not found in `description`.</span>
<span class="sd">        AssertionError: If a `description_type` is provided that is known to `_parse_description` but</span>
<span class="sd">            not `extract_annotation`. This indicates an internal bug and should be reported.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># regions are a special case because they can overlap</span>
    <span class="k">if</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;REGION&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_region_parsing</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">matches</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_description</span><span class="p">(</span>
        <span class="n">description_type</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">extract_metadata</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;ACT_SITE&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;BINDING&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binding</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;MOD_RES&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;DNA_BIND&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;DISULFID&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;STRAND&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;HELIX&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helix</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">elif</span> <span class="n">description_type</span> <span class="o">==</span> <span class="s2">&quot;TURN&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turn</span> <span class="o">=</span> <span class="n">matches</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;If this is raised, the description type </span><span class="si">{</span><span class="n">description_type</span><span class="si">}</span><span class="s2"> is only partially handled. Please file an issue.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">table</span><span class="p">()</span></code>

<a href="#procaliper.site_metadata.uniprot_site_parsing.SiteAnnotations.table" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Return a dictionary of the data in the SiteAnnotations object.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, list[Any]]: Each key is a site annotation feature name.
Each value is a list of the values for that feature.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/site_metadata/uniprot_site_parsing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the data in the SiteAnnotations object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, list[Any]]: Each key is a site annotation feature name.</span>
<span class="sd">            Each value is a list of the values for that feature.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tbl</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;residue_letter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_letter</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;residue_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;binding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;active&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;ptm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptm</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;dna_binding&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dna_binding</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;disulfide_bond&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">disulfide_bond</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;helix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helix</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;turn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">turn</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;beta_strand&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_strand</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;binding_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_data</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;active_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_data</span>
    <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;ptm_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptm_data</span>

    <span class="k">return</span> <span class="n">tbl</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="procaliper.view" class="doc doc-heading">
            <code>view</code>


<a href="#procaliper.view" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="procaliper.view.ngl_scheme" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ngl_scheme</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">float_to_hex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">two_sided</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#procaliper.view.ngl_scheme" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Converts a list of values to an nglview color scheme.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code>list[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of values to convert.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>float_to_hex</code></td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[float], str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that
converts a float to a hex color in the form <code>"#RRGGBB"</code>. If <code>None</code>,
a default function is used that interpolates between white and green
(one-sided) or red and blue (two-sided). Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>two_sided</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use a two-sided color scheme. If
<code>False</code>, we assume <code>data</code> only contains positive values. Defaults to
<code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple[str, str]]: A list of color and residue number tuples that
are compatible with nglview.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/view/nglview_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ngl_scheme</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">float_to_hex</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">two_sided</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a list of values to an nglview color scheme.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list[float]): The list of values to convert.</span>
<span class="sd">        float_to_hex (Callable[[float], str] | None, optional): Function that</span>
<span class="sd">            converts a float to a hex color in the form `&quot;#RRGGBB&quot;`. If `None`,</span>
<span class="sd">            a default function is used that interpolates between white and green</span>
<span class="sd">            (one-sided) or red and blue (two-sided). Defaults to `None`.</span>
<span class="sd">        two_sided (bool, optional): Whether to use a two-sided color scheme. If</span>
<span class="sd">            `False`, we assume `data` only contains positive values. Defaults to</span>
<span class="sd">            `False`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[tuple[str, str]]: A list of color and residue number tuples that</span>
<span class="sd">            are compatible with nglview.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">float_to_hex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">two_sided</span><span class="p">:</span>
            <span class="n">float_to_hex</span> <span class="o">=</span> <span class="n">_default_float_to_hex_rb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">float_to_hex</span> <span class="o">=</span> <span class="n">_default_float_to_hex</span>

    <span class="n">maxx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">maxx</span><span class="p">))</span> <span class="k">if</span> <span class="n">two_sided</span> <span class="k">else</span> <span class="n">maxx</span>

    <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">data_scaled</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_scaled</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">/</span> <span class="n">maxx</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">[(</span><span class="n">float_to_hex</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="procaliper.view.protein_to_nglview" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">protein_to_nglview</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span></code>

<a href="#procaliper.view.protein_to_nglview" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generates an nglview widget from a protein that has an associated PDB file.</p>
<p>Must run <code>protein.fetch_pdb</code> first or specify an abosulute path to the PDB
in <code>protein.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>protein</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper._protein.Protein" href="#procaliper.Protein">Protein</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The protein object to visualize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the PDB location is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="nglview.NGLWidget">NGLWidget</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nglview.NGLWidget: an nglview widget</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/view/nglview_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">protein_to_nglview</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nglview</span><span class="o">.</span><span class="n">NGLWidget</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates an nglview widget from a protein that has an associated PDB file.</span>

<span class="sd">    Must run `protein.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    in `protein.pdb_location_absolute`.</span>

<span class="sd">    Args:</span>
<span class="sd">        protein (Protein): The protein object to visualize.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the PDB location is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nglview.NGLWidget: an nglview widget</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">protein</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PDB location not set; use `fetch_pdb` first&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nglview</span><span class="o">.</span><span class="n">show_file</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>


<div class="doc doc-object doc-module">



<h3 id="procaliper.view.nglview_utils" class="doc doc-heading">
            <code>nglview_utils</code>


<a href="#procaliper.view.nglview_utils" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="procaliper.view.nglview_utils.ngl_scheme" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ngl_scheme</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">float_to_hex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">two_sided</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#procaliper.view.nglview_utils.ngl_scheme" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Converts a list of values to an nglview color scheme.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code>list[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of values to convert.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>float_to_hex</code></td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[float], str] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that
converts a float to a hex color in the form <code>"#RRGGBB"</code>. If <code>None</code>,
a default function is used that interpolates between white and green
(one-sided) or red and blue (two-sided). Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>two_sided</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use a two-sided color scheme. If
<code>False</code>, we assume <code>data</code> only contains positive values. Defaults to
<code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple[str, str]]: A list of color and residue number tuples that
are compatible with nglview.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/view/nglview_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ngl_scheme</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">float_to_hex</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">two_sided</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a list of values to an nglview color scheme.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list[float]): The list of values to convert.</span>
<span class="sd">        float_to_hex (Callable[[float], str] | None, optional): Function that</span>
<span class="sd">            converts a float to a hex color in the form `&quot;#RRGGBB&quot;`. If `None`,</span>
<span class="sd">            a default function is used that interpolates between white and green</span>
<span class="sd">            (one-sided) or red and blue (two-sided). Defaults to `None`.</span>
<span class="sd">        two_sided (bool, optional): Whether to use a two-sided color scheme. If</span>
<span class="sd">            `False`, we assume `data` only contains positive values. Defaults to</span>
<span class="sd">            `False`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[tuple[str, str]]: A list of color and residue number tuples that</span>
<span class="sd">            are compatible with nglview.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">float_to_hex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">two_sided</span><span class="p">:</span>
            <span class="n">float_to_hex</span> <span class="o">=</span> <span class="n">_default_float_to_hex_rb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">float_to_hex</span> <span class="o">=</span> <span class="n">_default_float_to_hex</span>

    <span class="n">maxx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">maxx</span><span class="p">))</span> <span class="k">if</span> <span class="n">two_sided</span> <span class="k">else</span> <span class="n">maxx</span>

    <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">data_scaled</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data_scaled</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">/</span> <span class="n">maxx</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">[(</span><span class="n">float_to_hex</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_scaled</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="procaliper.view.nglview_utils.protein_to_nglview" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">protein_to_nglview</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span></code>

<a href="#procaliper.view.nglview_utils.protein_to_nglview" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Generates an nglview widget from a protein that has an associated PDB file.</p>
<p>Must run <code>protein.fetch_pdb</code> first or specify an abosulute path to the PDB
in <code>protein.pdb_location_absolute</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>protein</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="procaliper._protein.Protein" href="#procaliper.Protein">Protein</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The protein object to visualize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the PDB location is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="nglview.NGLWidget">NGLWidget</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nglview.NGLWidget: an nglview widget</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>procaliper/view/nglview_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">protein_to_nglview</span><span class="p">(</span><span class="n">protein</span><span class="p">:</span> <span class="n">Protein</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nglview</span><span class="o">.</span><span class="n">NGLWidget</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates an nglview widget from a protein that has an associated PDB file.</span>

<span class="sd">    Must run `protein.fetch_pdb` first or specify an abosulute path to the PDB</span>
<span class="sd">    in `protein.pdb_location_absolute`.</span>

<span class="sd">    Args:</span>
<span class="sd">        protein (Protein): The protein object to visualize.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the PDB location is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nglview.NGLWidget: an nglview widget</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">protein</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PDB location not set; use `fetch_pdb` first&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nglview</span><span class="o">.</span><span class="n">show_file</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">pdb_location_absolute</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="http://www.jieyu.ai" target="_blank" rel="noopener" title="Tweet" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
    <a href="http://www.jieyu.ai" target="_blank" rel="noopener" title="Facebook" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/LifeWorks/procaliper" target="_blank" rel="noopener" title="Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:song.feng@pnnl.gov" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes", "navigation.tabs", "navigation.instant", "navigation.tabs.sticky"], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>